<mxfile host="app.diagrams.net" agent="Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/132.0.0.0 Safari/537.36 SberBrowser/24.0.0.0" version="26.1.1">
  <diagram name="Страница — 1" id="I-Ke2cOXVvFwzJxJ1-Up">
    <mxGraphModel dx="2207" dy="6583" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="827" pageHeight="1169" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        <mxCell id="MsBQBtv89PaCHF0zLTBD-1" value="" style="whiteSpace=wrap;html=1;aspect=fixed;" parent="1" vertex="1">
          <mxGeometry x="120" y="80" width="510" height="510" as="geometry" />
        </mxCell>
        <mxCell id="MsBQBtv89PaCHF0zLTBD-2" value="&lt;div style=&quot;background-color:#ffffff;color:#080808&quot;&gt;&lt;pre style=&quot;font-family:&#39;JetBrains Mono&#39;,monospace;font-size:9,8pt;&quot;&gt;&lt;span style=&quot;color:#0033b3;&quot;&gt;import &lt;/span&gt;requests&lt;br&gt;&lt;span style=&quot;color:#0033b3;&quot;&gt;from &lt;/span&gt;scenarios.user.user_model &lt;span style=&quot;color:#0033b3;&quot;&gt;import &lt;/span&gt;User&lt;br&gt;&lt;span style=&quot;color:#0033b3;&quot;&gt;from &lt;/span&gt;core.logging.logger_utils &lt;span style=&quot;color:#0033b3;&quot;&gt;import &lt;/span&gt;log&lt;br&gt;&lt;span style=&quot;color:#0033b3;&quot;&gt;import &lt;/span&gt;json&lt;br&gt;&lt;span style=&quot;color:#0033b3;&quot;&gt;import &lt;/span&gt;os&lt;br&gt;&lt;span style=&quot;color:#0033b3;&quot;&gt;import &lt;/span&gt;datetime&lt;br&gt;&lt;span style=&quot;color:#0033b3;&quot;&gt;import &lt;/span&gt;pandas &lt;span style=&quot;color:#0033b3;&quot;&gt;as &lt;/span&gt;pd&lt;br&gt;&lt;span style=&quot;color:#0033b3;&quot;&gt;import &lt;/span&gt;base64&lt;br&gt;&lt;span style=&quot;color:#0033b3;&quot;&gt;import &lt;/span&gt;io&lt;br&gt;&lt;span style=&quot;color:#0033b3;&quot;&gt;from &lt;/span&gt;app.basic_entities.utils.rejections.api6 &lt;span style=&quot;color:#0033b3;&quot;&gt;import &lt;/span&gt;send_get_request &lt;span style=&quot;color:#0033b3;&quot;&gt;as &lt;/span&gt;send_get_request_6&lt;br&gt;&lt;span style=&quot;color:#0033b3;&quot;&gt;from &lt;/span&gt;app.basic_entities.utils.rejections.api7 &lt;span style=&quot;color:#0033b3;&quot;&gt;import &lt;/span&gt;send_get_request &lt;span style=&quot;color:#0033b3;&quot;&gt;as &lt;/span&gt;send_get_request_7&lt;br&gt;&lt;span style=&quot;color:#0033b3;&quot;&gt;from &lt;/span&gt;app.basic_entities.utils.rejections.api8 &lt;span style=&quot;color:#0033b3;&quot;&gt;import &lt;/span&gt;send_get_request &lt;span style=&quot;color:#0033b3;&quot;&gt;as &lt;/span&gt;send_get_request_8&lt;br&gt;&lt;span style=&quot;color:#0033b3;&quot;&gt;from &lt;/span&gt;app.basic_entities.utils.rejections.api5 &lt;span style=&quot;color:#0033b3;&quot;&gt;import &lt;/span&gt;send_request&lt;br&gt;&lt;br&gt;&lt;span style=&quot;color:#0033b3;&quot;&gt;def &lt;/span&gt;&lt;span style=&quot;color:#00627a;&quot;&gt;get_human_readable_product_name&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;prod_name&lt;/span&gt;: &lt;span style=&quot;color:#000080;&quot;&gt;str&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;) &lt;/span&gt;-&amp;gt; &lt;span style=&quot;color:#000080;&quot;&gt;str&lt;/span&gt;:&lt;br&gt;    &lt;span style=&quot;color:#000000;&quot;&gt;products &lt;/span&gt;= &lt;span style=&quot;color:#3f9101;&quot;&gt;{&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;&quot;CORP_CRED&quot;&lt;/span&gt;:&lt;span style=&quot;color:#067d17;&quot;&gt;&quot;Корпоративное кредитование - ВРКЛДС&quot;&lt;/span&gt;,&lt;br&gt;    &lt;span style=&quot;color:#067d17;&quot;&gt;&quot;CORP_CRED_VKL_NKL&quot;&lt;/span&gt;:&lt;span style=&quot;color:#067d17;&quot;&gt;&quot;Корпоративное кредитование НКЛ, ВКЛ&quot;&lt;/span&gt;,&lt;br&gt;    &lt;span style=&quot;color:#067d17;&quot;&gt;&quot;OVERDRAFT&quot;&lt;/span&gt;:&lt;span style=&quot;color:#067d17;&quot;&gt;&quot;Овердрафт&quot;&lt;/span&gt;,&lt;br&gt;    &lt;span style=&quot;color:#067d17;&quot;&gt;&quot;CUSTOMS&quot;&lt;/span&gt;:&lt;span style=&quot;color:#067d17;&quot;&gt;&quot;Таможенные гарантии&quot;&lt;/span&gt;,&lt;br&gt;    &lt;span style=&quot;color:#067d17;&quot;&gt;&quot;NDS&quot;&lt;/span&gt;:&lt;span style=&quot;color:#067d17;&quot;&gt;&quot;НДС гарантии&quot;&lt;/span&gt;,&lt;br&gt;    &lt;span style=&quot;color:#067d17;&quot;&gt;&quot;EXCISE&quot;&lt;/span&gt;:&lt;span style=&quot;color:#067d17;&quot;&gt;&quot;Акцизные гарантии&quot;&lt;/span&gt;,&lt;br&gt;    &lt;span style=&quot;color:#067d17;&quot;&gt;&quot;TENDER&quot;&lt;/span&gt;:&lt;span style=&quot;color:#067d17;&quot;&gt;&quot;Тендерные гарантии&quot;&lt;/span&gt;,&lt;br&gt;    &lt;span style=&quot;color:#067d17;&quot;&gt;&quot;CONTRACTUAL&quot;&lt;/span&gt;:&lt;span style=&quot;color:#067d17;&quot;&gt;&quot;Договорные гарантии&quot;&lt;/span&gt;,&lt;br&gt;    &lt;span style=&quot;color:#067d17;&quot;&gt;&quot;CONTRACTUAL_FZ&quot;&lt;/span&gt;:&lt;span style=&quot;color:#067d17;&quot;&gt;&quot;Договорные ФЗ гарантии&quot;&lt;/span&gt;,&lt;br&gt;    &lt;span style=&quot;color:#067d17;&quot;&gt;&quot;FINANCIAL&quot;&lt;/span&gt;:&lt;span style=&quot;color:#067d17;&quot;&gt;&quot;Финансовые гарантии&quot;&lt;/span&gt;,&lt;br&gt;    &lt;span style=&quot;color:#067d17;&quot;&gt;&quot;LEASING&quot;&lt;/span&gt;:&lt;span style=&quot;color:#067d17;&quot;&gt;&quot;Лизинг&quot;&lt;/span&gt;,&lt;br&gt;    &lt;span style=&quot;color:#067d17;&quot;&gt;&quot;FACTORING&quot;&lt;/span&gt;:&lt;span style=&quot;color:#067d17;&quot;&gt;&quot;Факторинг&quot;&lt;/span&gt;,&lt;br&gt;    &lt;span style=&quot;color:#067d17;&quot;&gt;&quot;UNCOVERED_LETTER_OF_CREDIT&quot;&lt;/span&gt;:&lt;span style=&quot;color:#067d17;&quot;&gt;&quot;Непокрытые аккредитивы&quot;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;}&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color:#0033b3;&quot;&gt;return &lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;products&lt;/span&gt;.get&lt;span style=&quot;color:#3f9101;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;prod_name&lt;/span&gt;, &lt;span style=&quot;color:#000000;&quot;&gt;prod_name&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;)&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#0033b3;&quot;&gt;def &lt;/span&gt;&lt;span style=&quot;color:#00627a;&quot;&gt;get_error_code&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;bpIds_with_clusters&lt;/span&gt;: &lt;span style=&quot;color:#000080;&quot;&gt;list&lt;/span&gt;, &lt;span style=&quot;color:#000000;&quot;&gt;epk_id&lt;/span&gt;: &lt;span style=&quot;color:#000080;&quot;&gt;str&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;) &lt;/span&gt;-&amp;gt; &lt;span style=&quot;color:#000080;&quot;&gt;list&lt;/span&gt;:&lt;br&gt;    &lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;&quot;&quot;&quot;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    Возвращает список объектов с ошибками из трех API сервисов.&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    Собирает ответы со всех сервисов независимо от результатов предыдущих.&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    Args:&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;        bpIds_with_clusters: Список словарей с идентификаторами бизнес-процессов и их кластерами&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;        epk_id: Идентификатор организации&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    Returns:&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;        list: Список объектов с ошибками в формате:&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;            [&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;                {&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;                    &#39;source&#39;: &#39;api6|api7|api8&#39;,&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;                    &#39;bpId&#39;: str,&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;                    &#39;code&#39;: str,&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;                    &#39;description&#39;: str,&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;                    &#39;cluster&#39;: str&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;                },&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;                ...&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;            ]&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    &quot;&quot;&quot;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;errors &lt;/span&gt;= &lt;span style=&quot;color:#3f9101;&quot;&gt;[]  &lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;# Список для хранения объектов с ошибками&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    # Собираем все уникальные кластеры&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;clusters &lt;/span&gt;= &lt;span style=&quot;color:#3f9101;&quot;&gt;{&lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;bp_info&lt;/span&gt;&lt;span style=&quot;color:#0e4a8e;&quot;&gt;[&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;&#39;cluster&#39;&lt;/span&gt;&lt;span style=&quot;color:#0e4a8e;&quot;&gt;] &lt;/span&gt;&lt;span style=&quot;color:#0033b3;&quot;&gt;for &lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;bp_info &lt;/span&gt;&lt;span style=&quot;color:#0033b3;&quot;&gt;in &lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;bpIds_with_clusters&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;}&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color:#0033b3;&quot;&gt;for &lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;bp_info &lt;/span&gt;&lt;span style=&quot;color:#0033b3;&quot;&gt;in &lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;bpIds_with_clusters&lt;/span&gt;:&lt;br&gt;        &lt;span style=&quot;color:#000000;&quot;&gt;bpId &lt;/span&gt;= &lt;span style=&quot;color:#000000;&quot;&gt;bp_info&lt;/span&gt;.get&lt;span style=&quot;color:#3f9101;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;&#39;bpId&#39;&lt;/span&gt;,&lt;span style=&quot;color:#067d17;&quot;&gt;&#39;&#39;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;)&lt;/span&gt;.get&lt;span style=&quot;color:#3f9101;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;&#39;bpId&#39;&lt;/span&gt;, &lt;span style=&quot;color:#067d17;&quot;&gt;&#39;&#39;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;)&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;        &lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;cluster &lt;/span&gt;= &lt;span style=&quot;color:#000000;&quot;&gt;bp_info&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;[&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;&#39;cluster&#39;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;]&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;        &lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;# Получаем отсечения из API6&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;        &lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;api6_response &lt;/span&gt;= send_get_request_6&lt;span style=&quot;color:#3f9101;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;bpId&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;)&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;        &lt;/span&gt;log&lt;span style=&quot;color:#3f9101;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;f&quot;API6 response for bpId &lt;/span&gt;&lt;span style=&quot;color:#0e4a8e;&quot;&gt;{&lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;bpId&lt;/span&gt;&lt;span style=&quot;color:#0e4a8e;&quot;&gt;}&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;: &lt;/span&gt;&lt;span style=&quot;color:#0e4a8e;&quot;&gt;{&lt;/span&gt;&lt;span style=&quot;color:#000080;&quot;&gt;type&lt;/span&gt;&lt;span style=&quot;color:#b4960a;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;api6_response&lt;/span&gt;&lt;span style=&quot;color:#b4960a;&quot;&gt;)&lt;/span&gt;&lt;span style=&quot;color:#0e4a8e;&quot;&gt;}&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;&quot;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;)&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;        &lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;# API6 возвращает объект с errorCode и errorDescription&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;        &lt;/span&gt;&lt;span style=&quot;color:#0033b3;&quot;&gt;if &lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;api6_response &lt;/span&gt;&lt;span style=&quot;color:#0033b3;&quot;&gt;and &lt;/span&gt;&lt;span style=&quot;color:#000080;&quot;&gt;isinstance&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;api6_response&lt;/span&gt;, &lt;span style=&quot;color:#000080;&quot;&gt;dict&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;)&lt;/span&gt;:&lt;br&gt;            log&lt;span style=&quot;color:#3f9101;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;f&quot;ПОЛУЧЕН ОТВЕТ ОТ API6 response for bpId &lt;/span&gt;&lt;span style=&quot;color:#0e4a8e;&quot;&gt;{&lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;bpId&lt;/span&gt;&lt;span style=&quot;color:#0e4a8e;&quot;&gt;}&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;: &lt;/span&gt;&lt;span style=&quot;color:#0e4a8e;&quot;&gt;{&lt;/span&gt;&lt;span style=&quot;color:#000080;&quot;&gt;str&lt;/span&gt;&lt;span style=&quot;color:#b4960a;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;api6_response&lt;/span&gt;&lt;span style=&quot;color:#b4960a;&quot;&gt;)&lt;/span&gt;&lt;span style=&quot;color:#0e4a8e;&quot;&gt;}&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;&quot;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;)&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;            &lt;/span&gt;&lt;span style=&quot;color:#0033b3;&quot;&gt;if &lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;api6_response&lt;/span&gt;.get&lt;span style=&quot;color:#3f9101;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;&#39;errorCode&#39;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;)&lt;/span&gt;:&lt;br&gt;                &lt;span style=&quot;color:#000000;&quot;&gt;errors&lt;/span&gt;.append&lt;span style=&quot;color:#3f9101;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#0e4a8e;&quot;&gt;{&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#0e4a8e;&quot;&gt;                    &lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;&#39;source&#39;&lt;/span&gt;: &lt;span style=&quot;color:#067d17;&quot;&gt;&#39;api6&#39;&lt;/span&gt;,&lt;br&gt;                    &lt;span style=&quot;color:#067d17;&quot;&gt;&#39;bpId&#39;&lt;/span&gt;: &lt;span style=&quot;color:#000000;&quot;&gt;bpId&lt;/span&gt;,&lt;br&gt;                    &lt;span style=&quot;color:#067d17;&quot;&gt;&#39;code&#39;&lt;/span&gt;: &lt;span style=&quot;color:#000000;&quot;&gt;api6_response&lt;/span&gt;&lt;span style=&quot;color:#b4960a;&quot;&gt;[&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;&#39;errorCode&#39;&lt;/span&gt;&lt;span style=&quot;color:#b4960a;&quot;&gt;]&lt;/span&gt;,&lt;br&gt;                    &lt;span style=&quot;color:#067d17;&quot;&gt;&#39;description&#39;&lt;/span&gt;: &lt;span style=&quot;color:#000000;&quot;&gt;api6_response&lt;/span&gt;.get&lt;span style=&quot;color:#b4960a;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;&#39;errorDescription&#39;&lt;/span&gt;, &lt;span style=&quot;color:#067d17;&quot;&gt;&#39;&#39;&lt;/span&gt;&lt;span style=&quot;color:#b4960a;&quot;&gt;)&lt;/span&gt;,&lt;br&gt;                    &lt;span style=&quot;color:#067d17;&quot;&gt;&#39;cluster&#39;&lt;/span&gt;: &lt;span style=&quot;color:#000000;&quot;&gt;cluster&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;                &lt;/span&gt;&lt;span style=&quot;color:#0e4a8e;&quot;&gt;}&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;)&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;        &lt;/span&gt;&lt;span style=&quot;color:#0033b3;&quot;&gt;else&lt;/span&gt;:&lt;br&gt;            log&lt;span style=&quot;color:#3f9101;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;f&quot;НЕТ ДАННЫХ ОТ API6 response for bpId &lt;/span&gt;&lt;span style=&quot;color:#0e4a8e;&quot;&gt;{&lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;bpId&lt;/span&gt;&lt;span style=&quot;color:#0e4a8e;&quot;&gt;}&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt; is not a dictionary: &lt;/span&gt;&lt;span style=&quot;color:#0e4a8e;&quot;&gt;{&lt;/span&gt;&lt;span style=&quot;color:#000080;&quot;&gt;str&lt;/span&gt;&lt;span style=&quot;color:#b4960a;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;api6_response&lt;/span&gt;&lt;span style=&quot;color:#b4960a;&quot;&gt;)&lt;/span&gt;&lt;span style=&quot;color:#0e4a8e;&quot;&gt;}&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;&quot;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;)&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;        &lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;# Получаем отсечения из API7&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;        &lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;api7_response &lt;/span&gt;= send_get_request_7&lt;span style=&quot;color:#3f9101;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;bpId&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;)&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;        &lt;/span&gt;log&lt;span style=&quot;color:#3f9101;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;f&quot;API7 response for bpId &lt;/span&gt;&lt;span style=&quot;color:#0e4a8e;&quot;&gt;{&lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;bpId&lt;/span&gt;&lt;span style=&quot;color:#0e4a8e;&quot;&gt;}&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;: &lt;/span&gt;&lt;span style=&quot;color:#0e4a8e;&quot;&gt;{&lt;/span&gt;&lt;span style=&quot;color:#000080;&quot;&gt;type&lt;/span&gt;&lt;span style=&quot;color:#b4960a;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;api7_response&lt;/span&gt;&lt;span style=&quot;color:#b4960a;&quot;&gt;)&lt;/span&gt;&lt;span style=&quot;color:#0e4a8e;&quot;&gt;}&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;&quot;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;)&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;        &lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;# API7 возвращает объект с clustId и массивом checks&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;        &lt;/span&gt;&lt;span style=&quot;color:#0033b3;&quot;&gt;if &lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;api7_response &lt;/span&gt;&lt;span style=&quot;color:#0033b3;&quot;&gt;and &lt;/span&gt;&lt;span style=&quot;color:#000080;&quot;&gt;isinstance&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;api7_response&lt;/span&gt;, &lt;span style=&quot;color:#000080;&quot;&gt;dict&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;)&lt;/span&gt;:&lt;br&gt;            log&lt;span style=&quot;color:#3f9101;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;f&quot;ПОЛУЧЕН ОТВЕТ ОТ API7 response for bpId &lt;/span&gt;&lt;span style=&quot;color:#0e4a8e;&quot;&gt;{&lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;bpId&lt;/span&gt;&lt;span style=&quot;color:#0e4a8e;&quot;&gt;}&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;: &lt;/span&gt;&lt;span style=&quot;color:#0e4a8e;&quot;&gt;{&lt;/span&gt;&lt;span style=&quot;color:#000080;&quot;&gt;str&lt;/span&gt;&lt;span style=&quot;color:#b4960a;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;api7_response&lt;/span&gt;&lt;span style=&quot;color:#b4960a;&quot;&gt;)&lt;/span&gt;&lt;span style=&quot;color:#0e4a8e;&quot;&gt;}&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;&quot;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;)&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;            &lt;/span&gt;&lt;span style=&quot;color:#808080;&quot;&gt;clust_id &lt;/span&gt;= &lt;span style=&quot;color:#000000;&quot;&gt;api7_response&lt;/span&gt;.get&lt;span style=&quot;color:#3f9101;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;&#39;clustId&#39;&lt;/span&gt;, &lt;span style=&quot;color:#067d17;&quot;&gt;&#39;&#39;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;)&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;            &lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;checks &lt;/span&gt;= &lt;span style=&quot;color:#000000;&quot;&gt;api7_response&lt;/span&gt;.get&lt;span style=&quot;color:#3f9101;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;&#39;checks&#39;&lt;/span&gt;, &lt;span style=&quot;color:#0e4a8e;&quot;&gt;[]&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;)&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;            &lt;/span&gt;&lt;span style=&quot;color:#0033b3;&quot;&gt;for &lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;check &lt;/span&gt;&lt;span style=&quot;color:#0033b3;&quot;&gt;in &lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;checks&lt;/span&gt;:&lt;br&gt;                &lt;span style=&quot;color:#0033b3;&quot;&gt;if &lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;check&lt;/span&gt;.get&lt;span style=&quot;color:#3f9101;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;&#39;result&#39;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;) &lt;/span&gt;== &lt;span style=&quot;color:#067d17;&quot;&gt;&#39;FAIL&#39; &lt;/span&gt;&lt;span style=&quot;color:#0033b3;&quot;&gt;or &lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;check&lt;/span&gt;.get&lt;span style=&quot;color:#3f9101;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;&#39;result&#39;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;) &lt;/span&gt;== &lt;span style=&quot;color:#067d17;&quot;&gt;&#39;ERROR&#39;&lt;/span&gt;:&lt;br&gt;                    &lt;span style=&quot;color:#000000;&quot;&gt;errors&lt;/span&gt;.append&lt;span style=&quot;color:#3f9101;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#0e4a8e;&quot;&gt;{&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#0e4a8e;&quot;&gt;                        &lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;&#39;source&#39;&lt;/span&gt;: &lt;span style=&quot;color:#067d17;&quot;&gt;&#39;api7&#39;&lt;/span&gt;,&lt;br&gt;                        &lt;span style=&quot;color:#067d17;&quot;&gt;&#39;bpId&#39;&lt;/span&gt;: &lt;span style=&quot;color:#000000;&quot;&gt;bpId&lt;/span&gt;,&lt;br&gt;                        &lt;span style=&quot;color:#067d17;&quot;&gt;&#39;code&#39;&lt;/span&gt;: &lt;span style=&quot;color:#000000;&quot;&gt;check&lt;/span&gt;.get&lt;span style=&quot;color:#b4960a;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;&#39;code&#39;&lt;/span&gt;, &lt;span style=&quot;color:#067d17;&quot;&gt;&#39;&#39;&lt;/span&gt;&lt;span style=&quot;color:#b4960a;&quot;&gt;)&lt;/span&gt;,&lt;br&gt;                        &lt;span style=&quot;color:#067d17;&quot;&gt;&#39;description&#39;&lt;/span&gt;: &lt;span style=&quot;color:#000000;&quot;&gt;check&lt;/span&gt;.get&lt;span style=&quot;color:#b4960a;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;&#39;name&#39;&lt;/span&gt;, &lt;span style=&quot;color:#067d17;&quot;&gt;&#39;&#39;&lt;/span&gt;&lt;span style=&quot;color:#b4960a;&quot;&gt;)&lt;/span&gt;,&lt;br&gt;                        &lt;span style=&quot;color:#067d17;&quot;&gt;&#39;cluster&#39;&lt;/span&gt;: &lt;span style=&quot;color:#000000;&quot;&gt;cluster&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;                    &lt;/span&gt;&lt;span style=&quot;color:#0e4a8e;&quot;&gt;}&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;)&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;        &lt;/span&gt;&lt;span style=&quot;color:#0033b3;&quot;&gt;else&lt;/span&gt;:&lt;br&gt;            log&lt;span style=&quot;color:#3f9101;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;f&quot;НЕТ ДАННЫХ ОТ API7 response for bpId &lt;/span&gt;&lt;span style=&quot;color:#0e4a8e;&quot;&gt;{&lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;bpId&lt;/span&gt;&lt;span style=&quot;color:#0e4a8e;&quot;&gt;}&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt; is not a dictionary: &lt;/span&gt;&lt;span style=&quot;color:#0e4a8e;&quot;&gt;{&lt;/span&gt;&lt;span style=&quot;color:#000080;&quot;&gt;str&lt;/span&gt;&lt;span style=&quot;color:#b4960a;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;api7_response&lt;/span&gt;&lt;span style=&quot;color:#b4960a;&quot;&gt;)&lt;/span&gt;&lt;span style=&quot;color:#0e4a8e;&quot;&gt;}&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;&quot;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;)&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;# Получаем отсечения из API8 (вызывается один раз для epk_id)&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;api8_response &lt;/span&gt;= send_get_request_8&lt;span style=&quot;color:#3f9101;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;epk_id&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;)&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;    &lt;/span&gt;log&lt;span style=&quot;color:#3f9101;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;f&quot;API8 response for epk_id &lt;/span&gt;&lt;span style=&quot;color:#0e4a8e;&quot;&gt;{&lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;epk_id&lt;/span&gt;&lt;span style=&quot;color:#0e4a8e;&quot;&gt;}&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;: &lt;/span&gt;&lt;span style=&quot;color:#0e4a8e;&quot;&gt;{&lt;/span&gt;&lt;span style=&quot;color:#000080;&quot;&gt;type&lt;/span&gt;&lt;span style=&quot;color:#b4960a;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;api8_response&lt;/span&gt;&lt;span style=&quot;color:#b4960a;&quot;&gt;)&lt;/span&gt;&lt;span style=&quot;color:#0e4a8e;&quot;&gt;}&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;&quot;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;)&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color:#0033b3;&quot;&gt;if &lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;api8_response &lt;/span&gt;&lt;span style=&quot;color:#0033b3;&quot;&gt;and &lt;/span&gt;&lt;span style=&quot;color:#000080;&quot;&gt;isinstance&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;api8_response&lt;/span&gt;, &lt;span style=&quot;color:#000080;&quot;&gt;dict&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;)&lt;/span&gt;:&lt;br&gt;        log&lt;span style=&quot;color:#3f9101;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;f&quot;ПОЛУЧЕН ОТВЕТ ОТ API8 response for epk_id &lt;/span&gt;&lt;span style=&quot;color:#0e4a8e;&quot;&gt;{&lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;epk_id&lt;/span&gt;&lt;span style=&quot;color:#0e4a8e;&quot;&gt;}&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;: &lt;/span&gt;&lt;span style=&quot;color:#0e4a8e;&quot;&gt;{&lt;/span&gt;&lt;span style=&quot;color:#000080;&quot;&gt;str&lt;/span&gt;&lt;span style=&quot;color:#b4960a;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;api8_response&lt;/span&gt;&lt;span style=&quot;color:#b4960a;&quot;&gt;)&lt;/span&gt;&lt;span style=&quot;color:#0e4a8e;&quot;&gt;}&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;&quot;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;)&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;        &lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;org_info &lt;/span&gt;= &lt;span style=&quot;color:#000000;&quot;&gt;api8_response&lt;/span&gt;.get&lt;span style=&quot;color:#3f9101;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;&#39;orgInfoByRoles&#39;&lt;/span&gt;, &lt;span style=&quot;color:#0e4a8e;&quot;&gt;{}&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;)&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;        &lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;# Проверяем все роли (borrowerInfo, suretyInfo, pledgerInfo)&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;        &lt;/span&gt;&lt;span style=&quot;color:#0033b3;&quot;&gt;for &lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;role&lt;/span&gt;, &lt;span style=&quot;color:#000000;&quot;&gt;info &lt;/span&gt;&lt;span style=&quot;color:#0033b3;&quot;&gt;in &lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;org_info&lt;/span&gt;.items&lt;span style=&quot;color:#3f9101;&quot;&gt;()&lt;/span&gt;:&lt;br&gt;            &lt;span style=&quot;color:#000000;&quot;&gt;checks_by_products &lt;/span&gt;= &lt;span style=&quot;color:#000000;&quot;&gt;info&lt;/span&gt;.get&lt;span style=&quot;color:#3f9101;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;&#39;checksByProducts&#39;&lt;/span&gt;, &lt;span style=&quot;color:#0e4a8e;&quot;&gt;[]&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;)&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;            &lt;/span&gt;&lt;span style=&quot;color:#0033b3;&quot;&gt;for &lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;product_check &lt;/span&gt;&lt;span style=&quot;color:#0033b3;&quot;&gt;in &lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;checks_by_products&lt;/span&gt;:&lt;br&gt;                &lt;span style=&quot;color:#000000;&quot;&gt;product_name &lt;/span&gt;= &lt;span style=&quot;color:#000000;&quot;&gt;product_check&lt;/span&gt;.get&lt;span style=&quot;color:#3f9101;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;&#39;productName&#39;&lt;/span&gt;, &lt;span style=&quot;color:#067d17;&quot;&gt;&#39;&#39;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;)&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;                &lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;# Проверяем, что productName соответствует одному из кластеров&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;                &lt;/span&gt;&lt;span style=&quot;color:#0033b3;&quot;&gt;if &lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;product_name &lt;/span&gt;&lt;span style=&quot;color:#0033b3;&quot;&gt;in &lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;clusters &lt;/span&gt;&lt;span style=&quot;color:#0033b3;&quot;&gt;and &lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;product_check&lt;/span&gt;.get&lt;span style=&quot;color:#3f9101;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;&#39;checkStatus&#39;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;) &lt;/span&gt;&lt;span style=&quot;color:#0033b3;&quot;&gt;is False&lt;/span&gt;:&lt;br&gt;                    &lt;span style=&quot;color:#000000;&quot;&gt;ckp_checks &lt;/span&gt;= &lt;span style=&quot;color:#000000;&quot;&gt;product_check&lt;/span&gt;.get&lt;span style=&quot;color:#3f9101;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;&#39;ckpChecks&#39;&lt;/span&gt;, &lt;span style=&quot;color:#0e4a8e;&quot;&gt;[]&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;)&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;                    &lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;# Собираем все неуспешные проверки&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;                    &lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;failed_checks &lt;/span&gt;= &lt;span style=&quot;color:#3f9101;&quot;&gt;[&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;                        &lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;check &lt;/span&gt;&lt;span style=&quot;color:#0033b3;&quot;&gt;for &lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;check &lt;/span&gt;&lt;span style=&quot;color:#0033b3;&quot;&gt;in &lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;ckp_checks&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;                        &lt;/span&gt;&lt;span style=&quot;color:#0033b3;&quot;&gt;if &lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;check&lt;/span&gt;.get&lt;span style=&quot;color:#0e4a8e;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;&#39;checkStatus&#39;&lt;/span&gt;&lt;span style=&quot;color:#0e4a8e;&quot;&gt;) &lt;/span&gt;&lt;span style=&quot;color:#0033b3;&quot;&gt;is False or &lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;check&lt;/span&gt;.get&lt;span style=&quot;color:#0e4a8e;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;&#39;checkStatus&#39;&lt;/span&gt;&lt;span style=&quot;color:#0e4a8e;&quot;&gt;) &lt;/span&gt;== &lt;span style=&quot;color:#067d17;&quot;&gt;&#39;FALSE&#39;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;                    &lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;]&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;                    &lt;/span&gt;&lt;span style=&quot;color:#0033b3;&quot;&gt;if &lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;failed_checks&lt;/span&gt;:&lt;br&gt;                        &lt;span style=&quot;color:#0033b3;&quot;&gt;for &lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;check &lt;/span&gt;&lt;span style=&quot;color:#0033b3;&quot;&gt;in &lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;failed_checks&lt;/span&gt;:&lt;br&gt;                            &lt;span style=&quot;color:#000000;&quot;&gt;errors&lt;/span&gt;.append&lt;span style=&quot;color:#3f9101;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#0e4a8e;&quot;&gt;{&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#0e4a8e;&quot;&gt;                                &lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;&#39;source&#39;&lt;/span&gt;: &lt;span style=&quot;color:#067d17;&quot;&gt;&#39;api8&#39;&lt;/span&gt;,&lt;br&gt;                                &lt;span style=&quot;color:#067d17;&quot;&gt;&#39;bpId&#39;&lt;/span&gt;: &lt;span style=&quot;color:#000000;&quot;&gt;epk_id&lt;/span&gt;,&lt;br&gt;                                &lt;span style=&quot;color:#067d17;&quot;&gt;&#39;code&#39;&lt;/span&gt;: &lt;span style=&quot;color:#000000;&quot;&gt;check&lt;/span&gt;.get&lt;span style=&quot;color:#b4960a;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;&#39;checkCode&#39;&lt;/span&gt;, &lt;span style=&quot;color:#067d17;&quot;&gt;&#39;&#39;&lt;/span&gt;&lt;span style=&quot;color:#b4960a;&quot;&gt;)&lt;/span&gt;,&lt;br&gt;                                &lt;span style=&quot;color:#067d17;&quot;&gt;&#39;description&#39;&lt;/span&gt;: &lt;span style=&quot;color:#067d17;&quot;&gt;f&quot;Отказ по продукту &lt;/span&gt;&lt;span style=&quot;color:#b4960a;&quot;&gt;{&lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;product_name&lt;/span&gt;&lt;span style=&quot;color:#b4960a;&quot;&gt;}&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt; для &lt;/span&gt;&lt;span style=&quot;color:#b4960a;&quot;&gt;{&lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;role&lt;/span&gt;&lt;span style=&quot;color:#b4960a;&quot;&gt;}&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;&quot;&lt;/span&gt;,&lt;br&gt;                                &lt;span style=&quot;color:#067d17;&quot;&gt;&#39;check_type&#39;&lt;/span&gt;: &lt;span style=&quot;color:#000000;&quot;&gt;check&lt;/span&gt;.get&lt;span style=&quot;color:#b4960a;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;&#39;checkType&#39;&lt;/span&gt;, &lt;span style=&quot;color:#067d17;&quot;&gt;&#39;&#39;&lt;/span&gt;&lt;span style=&quot;color:#b4960a;&quot;&gt;)&lt;/span&gt;,&lt;br&gt;                                &lt;span style=&quot;color:#067d17;&quot;&gt;&#39;cluster&#39;&lt;/span&gt;: &lt;span style=&quot;color:#000000;&quot;&gt;product_name&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;                            &lt;/span&gt;&lt;span style=&quot;color:#0e4a8e;&quot;&gt;}&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;)&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color:#0033b3;&quot;&gt;else&lt;/span&gt;:&lt;br&gt;        log&lt;span style=&quot;color:#3f9101;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;f&quot;НЕТ ДАННЫХ ОТ API8 response for epk_id &lt;/span&gt;&lt;span style=&quot;color:#0e4a8e;&quot;&gt;{&lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;epk_id&lt;/span&gt;&lt;span style=&quot;color:#0e4a8e;&quot;&gt;}&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt; is not a dictionary: &lt;/span&gt;&lt;span style=&quot;color:#0e4a8e;&quot;&gt;{&lt;/span&gt;&lt;span style=&quot;color:#000080;&quot;&gt;str&lt;/span&gt;&lt;span style=&quot;color:#b4960a;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;api8_response&lt;/span&gt;&lt;span style=&quot;color:#b4960a;&quot;&gt;)&lt;/span&gt;&lt;span style=&quot;color:#0e4a8e;&quot;&gt;}&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;&quot;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;)&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color:#0033b3;&quot;&gt;return &lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;errors&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#0033b3;&quot;&gt;def &lt;/span&gt;&lt;span style=&quot;color:#00627a;&quot;&gt;send_email_with_attach&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;attach_base64&lt;/span&gt;: &lt;span style=&quot;color:#000080;&quot;&gt;str&lt;/span&gt;, &lt;span style=&quot;color:#000000;&quot;&gt;filename&lt;/span&gt;: &lt;span style=&quot;color:#000080;&quot;&gt;str&lt;/span&gt;, &lt;span style=&quot;color:#000000;&quot;&gt;to_email&lt;/span&gt;: &lt;span style=&quot;color:#000080;&quot;&gt;str &lt;/span&gt;= &lt;span style=&quot;color:#0033b3;&quot;&gt;None&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;)&lt;/span&gt;:&lt;br&gt;    &lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;&quot;&quot;&quot;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    Отправляет email с вложением.&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    Args:&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;        attach_base64: Содержимое вложения в формате base64&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;        filename: Имя файла вложения&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;        to_email: Email получателя (если не указан, используется значение по умолчанию)&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    Returns:&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;        bool: True, если email отправлен успешно, False в случае ошибки&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    &quot;&quot;&quot;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color:#0033b3;&quot;&gt;try&lt;/span&gt;:&lt;br&gt;        &lt;span style=&quot;color:#000000;&quot;&gt;from_email &lt;/span&gt;= &lt;span style=&quot;color:#067d17;&quot;&gt;&quot;vas_drug_mail@sigma-exchtest.sbrf.ru&quot;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;        &lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;to_email &lt;/span&gt;= &lt;span style=&quot;color:#000000;&quot;&gt;to_email &lt;/span&gt;&lt;span style=&quot;color:#0033b3;&quot;&gt;or &lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;&quot;vas_dkpp@sigma-exchtest.sbrf.ru&quot;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;        &lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;subject &lt;/span&gt;= &lt;span style=&quot;color:#067d17;&quot;&gt;&quot;Проверка клиента на доступность продукта в ЦКП&quot;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;        &lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;body &lt;/span&gt;= &lt;span style=&quot;color:#067d17;&quot;&gt;&quot;Ознакомьтесь с информацией во вложении&quot;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;        &lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;uri &lt;/span&gt;= os.getenv&lt;span style=&quot;color:#3f9101;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;&#39;HOST_API&#39;&lt;/span&gt;, &lt;span style=&quot;color:#067d17;&quot;&gt;&#39;localhost:8080&#39;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;)&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;        &lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;uri &lt;/span&gt;= &lt;span style=&quot;color:#067d17;&quot;&gt;r&quot;http://&quot; &lt;/span&gt;+ &lt;span style=&quot;color:#000000;&quot;&gt;uri &lt;/span&gt;+ &lt;span style=&quot;color:#067d17;&quot;&gt;r&quot;/sberfriend-b2e-meeting/api/v1/outbox/send-attach&quot;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;        &lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;ca_root &lt;/span&gt;= &lt;span style=&quot;color:#067d17;&quot;&gt;&quot;/secrets/ca_root&quot;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;        &lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;headers &lt;/span&gt;= &lt;span style=&quot;color:#3f9101;&quot;&gt;{&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;&#39;Content-type&#39;&lt;/span&gt;: &lt;span style=&quot;color:#067d17;&quot;&gt;&#39;application/json&#39;&lt;/span&gt;, &lt;span style=&quot;color:#067d17;&quot;&gt;&#39;Accept&#39;&lt;/span&gt;: &lt;span style=&quot;color:#067d17;&quot;&gt;&#39;application/json&#39;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;}&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;        &lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;data &lt;/span&gt;= &lt;span style=&quot;color:#3f9101;&quot;&gt;{&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;            &lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;&quot;email&quot;&lt;/span&gt;: &lt;span style=&quot;color:#000000;&quot;&gt;from_email&lt;/span&gt;,&lt;br&gt;            &lt;span style=&quot;color:#067d17;&quot;&gt;&quot;toEmails&quot;&lt;/span&gt;: &lt;span style=&quot;color:#0e4a8e;&quot;&gt;[&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#0e4a8e;&quot;&gt;                &lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;to_email&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;            &lt;/span&gt;&lt;span style=&quot;color:#0e4a8e;&quot;&gt;]&lt;/span&gt;,&lt;br&gt;            &lt;span style=&quot;color:#067d17;&quot;&gt;&quot;importance&quot;&lt;/span&gt;: &lt;span style=&quot;color:#067d17;&quot;&gt;&quot;Normal&quot;&lt;/span&gt;,&lt;br&gt;            &lt;span style=&quot;color:#067d17;&quot;&gt;&quot;subject&quot;&lt;/span&gt;: &lt;span style=&quot;color:#000000;&quot;&gt;subject&lt;/span&gt;,&lt;br&gt;            &lt;span style=&quot;color:#067d17;&quot;&gt;&quot;body&quot;&lt;/span&gt;: &lt;span style=&quot;color:#000000;&quot;&gt;body&lt;/span&gt;,&lt;br&gt;            &lt;span style=&quot;color:#067d17;&quot;&gt;&quot;attachments&quot;&lt;/span&gt;: &lt;span style=&quot;color:#0e4a8e;&quot;&gt;[&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#0e4a8e;&quot;&gt;                &lt;/span&gt;&lt;span style=&quot;color:#b4960a;&quot;&gt;{&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#b4960a;&quot;&gt;                    &lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;&quot;name&quot;&lt;/span&gt;: &lt;span style=&quot;color:#000000;&quot;&gt;filename&lt;/span&gt;,&lt;br&gt;                    &lt;span style=&quot;color:#067d17;&quot;&gt;&quot;content&quot;&lt;/span&gt;: &lt;span style=&quot;color:#000000;&quot;&gt;attach_base64&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;                &lt;/span&gt;&lt;span style=&quot;color:#b4960a;&quot;&gt;}&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#b4960a;&quot;&gt;            &lt;/span&gt;&lt;span style=&quot;color:#0e4a8e;&quot;&gt;]&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#0e4a8e;&quot;&gt;        &lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;}&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;        &lt;/span&gt;log&lt;span style=&quot;color:#3f9101;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;f&quot;Отправка email с вложением на адрес: &lt;/span&gt;&lt;span style=&quot;color:#0e4a8e;&quot;&gt;{&lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;to_email&lt;/span&gt;&lt;span style=&quot;color:#0e4a8e;&quot;&gt;}&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;&quot;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;)&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;        &lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;# Проверяем наличие сертификата&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;        &lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;verify &lt;/span&gt;= &lt;span style=&quot;color:#000000;&quot;&gt;ca_root &lt;/span&gt;&lt;span style=&quot;color:#0033b3;&quot;&gt;if &lt;/span&gt;os.path.exists&lt;span style=&quot;color:#3f9101;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;ca_root&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;) &lt;/span&gt;&lt;span style=&quot;color:#0033b3;&quot;&gt;else False&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#0033b3;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#0033b3;&quot;&gt;        &lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;response &lt;/span&gt;= requests.post&lt;span style=&quot;color:#3f9101;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;uri&lt;/span&gt;, &lt;span style=&quot;color:#660099;&quot;&gt;json&lt;/span&gt;=&lt;span style=&quot;color:#000000;&quot;&gt;data&lt;/span&gt;, &lt;span style=&quot;color:#660099;&quot;&gt;headers&lt;/span&gt;=&lt;span style=&quot;color:#000000;&quot;&gt;headers&lt;/span&gt;, &lt;span style=&quot;color:#660099;&quot;&gt;verify&lt;/span&gt;=&lt;span style=&quot;color:#000000;&quot;&gt;verify&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;)&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;        &lt;/span&gt;&lt;span style=&quot;color:#0033b3;&quot;&gt;if &lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;response&lt;/span&gt;.status_code == &lt;span style=&quot;color:#1750eb;&quot;&gt;200&lt;/span&gt;:&lt;br&gt;            log&lt;span style=&quot;color:#3f9101;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;f&quot;Email с вложением успешно отправлен на адрес: &lt;/span&gt;&lt;span style=&quot;color:#0e4a8e;&quot;&gt;{&lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;to_email&lt;/span&gt;&lt;span style=&quot;color:#0e4a8e;&quot;&gt;}&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;&quot;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;)&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;            &lt;/span&gt;&lt;span style=&quot;color:#0033b3;&quot;&gt;return True&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#0033b3;&quot;&gt;        else&lt;/span&gt;:&lt;br&gt;            log&lt;span style=&quot;color:#3f9101;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;f&quot;Ошибка при отправке email с вложением: &lt;/span&gt;&lt;span style=&quot;color:#0e4a8e;&quot;&gt;{&lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;response&lt;/span&gt;.status_code&lt;span style=&quot;color:#0e4a8e;&quot;&gt;}&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt; - &lt;/span&gt;&lt;span style=&quot;color:#0e4a8e;&quot;&gt;{&lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;response&lt;/span&gt;.text&lt;span style=&quot;color:#0e4a8e;&quot;&gt;}&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;&quot;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;)&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;            &lt;/span&gt;&lt;span style=&quot;color:#0033b3;&quot;&gt;return False&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#0033b3;&quot;&gt;    except &lt;/span&gt;&lt;span style=&quot;color:#000080;&quot;&gt;Exception &lt;/span&gt;&lt;span style=&quot;color:#0033b3;&quot;&gt;as &lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;e&lt;/span&gt;:&lt;br&gt;        log&lt;span style=&quot;color:#3f9101;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;f&quot;Исключение при отправке email с вложением: &lt;/span&gt;&lt;span style=&quot;color:#0e4a8e;&quot;&gt;{&lt;/span&gt;&lt;span style=&quot;color:#000080;&quot;&gt;str&lt;/span&gt;&lt;span style=&quot;color:#b4960a;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;e&lt;/span&gt;&lt;span style=&quot;color:#b4960a;&quot;&gt;)&lt;/span&gt;&lt;span style=&quot;color:#0e4a8e;&quot;&gt;}&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;&quot;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;)&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;        &lt;/span&gt;&lt;span style=&quot;color:#0033b3;&quot;&gt;return False&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#0033b3;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#0033b3;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#0033b3;&quot;&gt;def &lt;/span&gt;&lt;span style=&quot;color:#00627a;&quot;&gt;send_email_with_text&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;report_html&lt;/span&gt;: &lt;span style=&quot;color:#000080;&quot;&gt;str&lt;/span&gt;, &lt;span style=&quot;color:#000000;&quot;&gt;to_email&lt;/span&gt;: &lt;span style=&quot;color:#000080;&quot;&gt;str &lt;/span&gt;= &lt;span style=&quot;color:#0033b3;&quot;&gt;None&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;)&lt;/span&gt;:&lt;br&gt;    &lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;&quot;&quot;&quot;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    Отправляет email с HTML-содержимым отчета без вложения.&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    Args:&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;        report_html: HTML-содержимое отчета&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;        to_email: Email получателя (если не указан, используется значение по умолчанию)&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    Returns:&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;        bool: True, если email отправлен успешно, False в случае ошибки&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    &quot;&quot;&quot;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color:#0033b3;&quot;&gt;try&lt;/span&gt;:&lt;br&gt;        &lt;span style=&quot;color:#000000;&quot;&gt;from_email &lt;/span&gt;= &lt;span style=&quot;color:#067d17;&quot;&gt;&quot;vas_drug_mail@sigma-exchtest.sbrf.ru&quot;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;        &lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;to_email &lt;/span&gt;= &lt;span style=&quot;color:#000000;&quot;&gt;to_email &lt;/span&gt;&lt;span style=&quot;color:#0033b3;&quot;&gt;or &lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;&quot;vas_dkpp@sigma-exchtest.sbrf.ru&quot;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;        &lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;subject &lt;/span&gt;= &lt;span style=&quot;color:#067d17;&quot;&gt;&quot;Проверка клиента на доступность продукта в ЦКП&quot;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;        &lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;uri &lt;/span&gt;= os.getenv&lt;span style=&quot;color:#3f9101;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;&#39;HOST_API&#39;&lt;/span&gt;, &lt;span style=&quot;color:#067d17;&quot;&gt;&#39;localhost:8080&#39;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;)&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;        &lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;uri &lt;/span&gt;= &lt;span style=&quot;color:#067d17;&quot;&gt;r&quot;http://&quot; &lt;/span&gt;+ &lt;span style=&quot;color:#000000;&quot;&gt;uri &lt;/span&gt;+ &lt;span style=&quot;color:#067d17;&quot;&gt;r&quot;/sberfriend-b2e-meeting/api/v1/outbox/send-email&quot;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;        &lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;ca_root &lt;/span&gt;= &lt;span style=&quot;color:#067d17;&quot;&gt;&quot;/secrets/ca_root&quot;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;        &lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;headers &lt;/span&gt;= &lt;span style=&quot;color:#3f9101;&quot;&gt;{&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;&#39;Content-type&#39;&lt;/span&gt;: &lt;span style=&quot;color:#067d17;&quot;&gt;&#39;application/json&#39;&lt;/span&gt;, &lt;span style=&quot;color:#067d17;&quot;&gt;&#39;Accept&#39;&lt;/span&gt;: &lt;span style=&quot;color:#067d17;&quot;&gt;&#39;application/json&#39;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;}&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;        &lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;data &lt;/span&gt;= &lt;span style=&quot;color:#3f9101;&quot;&gt;{&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;            &lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;&quot;email&quot;&lt;/span&gt;: &lt;span style=&quot;color:#000000;&quot;&gt;from_email&lt;/span&gt;,&lt;br&gt;            &lt;span style=&quot;color:#067d17;&quot;&gt;&quot;toEmails&quot;&lt;/span&gt;: &lt;span style=&quot;color:#0e4a8e;&quot;&gt;[&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#0e4a8e;&quot;&gt;                &lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;to_email&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;            &lt;/span&gt;&lt;span style=&quot;color:#0e4a8e;&quot;&gt;]&lt;/span&gt;,&lt;br&gt;            &lt;span style=&quot;color:#067d17;&quot;&gt;&quot;importance&quot;&lt;/span&gt;: &lt;span style=&quot;color:#067d17;&quot;&gt;&quot;Normal&quot;&lt;/span&gt;,&lt;br&gt;            &lt;span style=&quot;color:#067d17;&quot;&gt;&quot;subject&quot;&lt;/span&gt;: &lt;span style=&quot;color:#000000;&quot;&gt;subject&lt;/span&gt;,&lt;br&gt;            &lt;span style=&quot;color:#067d17;&quot;&gt;&quot;body&quot;&lt;/span&gt;: &lt;span style=&quot;color:#000000;&quot;&gt;report_html&lt;/span&gt;,&lt;br&gt;            &lt;span style=&quot;color:#067d17;&quot;&gt;&quot;isHtml&quot;&lt;/span&gt;: &lt;span style=&quot;color:#0033b3;&quot;&gt;True&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#0033b3;&quot;&gt;        &lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;}&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;        &lt;/span&gt;log&lt;span style=&quot;color:#3f9101;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;f&quot;Отправка HTML-отчета по email на адрес: &lt;/span&gt;&lt;span style=&quot;color:#0e4a8e;&quot;&gt;{&lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;to_email&lt;/span&gt;&lt;span style=&quot;color:#0e4a8e;&quot;&gt;}&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;&quot;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;)&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;        &lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;# Проверяем наличие сертификата&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;        &lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;verify &lt;/span&gt;= &lt;span style=&quot;color:#000000;&quot;&gt;ca_root &lt;/span&gt;&lt;span style=&quot;color:#0033b3;&quot;&gt;if &lt;/span&gt;os.path.exists&lt;span style=&quot;color:#3f9101;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;ca_root&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;) &lt;/span&gt;&lt;span style=&quot;color:#0033b3;&quot;&gt;else False&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#0033b3;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#0033b3;&quot;&gt;        &lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;response &lt;/span&gt;= requests.post&lt;span style=&quot;color:#3f9101;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;uri&lt;/span&gt;, &lt;span style=&quot;color:#660099;&quot;&gt;json&lt;/span&gt;=&lt;span style=&quot;color:#000000;&quot;&gt;data&lt;/span&gt;, &lt;span style=&quot;color:#660099;&quot;&gt;headers&lt;/span&gt;=&lt;span style=&quot;color:#000000;&quot;&gt;headers&lt;/span&gt;, &lt;span style=&quot;color:#660099;&quot;&gt;verify&lt;/span&gt;=&lt;span style=&quot;color:#000000;&quot;&gt;verify&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;)&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;        &lt;/span&gt;&lt;span style=&quot;color:#0033b3;&quot;&gt;if &lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;response&lt;/span&gt;.status_code == &lt;span style=&quot;color:#1750eb;&quot;&gt;200&lt;/span&gt;:&lt;br&gt;            log&lt;span style=&quot;color:#3f9101;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;f&quot;HTML-отчет успешно отправлен на адрес: &lt;/span&gt;&lt;span style=&quot;color:#0e4a8e;&quot;&gt;{&lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;to_email&lt;/span&gt;&lt;span style=&quot;color:#0e4a8e;&quot;&gt;}&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;&quot;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;)&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;            &lt;/span&gt;&lt;span style=&quot;color:#0033b3;&quot;&gt;return True&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#0033b3;&quot;&gt;        else&lt;/span&gt;:&lt;br&gt;            log&lt;span style=&quot;color:#3f9101;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;f&quot;Ошибка при отправке HTML-отчета: &lt;/span&gt;&lt;span style=&quot;color:#0e4a8e;&quot;&gt;{&lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;response&lt;/span&gt;.status_code&lt;span style=&quot;color:#0e4a8e;&quot;&gt;}&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt; - &lt;/span&gt;&lt;span style=&quot;color:#0e4a8e;&quot;&gt;{&lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;response&lt;/span&gt;.text&lt;span style=&quot;color:#0e4a8e;&quot;&gt;}&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;&quot;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;)&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;            &lt;/span&gt;&lt;span style=&quot;color:#0033b3;&quot;&gt;return False&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#0033b3;&quot;&gt;    except &lt;/span&gt;&lt;span style=&quot;color:#000080;&quot;&gt;Exception &lt;/span&gt;&lt;span style=&quot;color:#0033b3;&quot;&gt;as &lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;e&lt;/span&gt;:&lt;br&gt;        log&lt;span style=&quot;color:#3f9101;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;f&quot;Исключение при отправке HTML-отчета: &lt;/span&gt;&lt;span style=&quot;color:#0e4a8e;&quot;&gt;{&lt;/span&gt;&lt;span style=&quot;color:#000080;&quot;&gt;str&lt;/span&gt;&lt;span style=&quot;color:#b4960a;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;e&lt;/span&gt;&lt;span style=&quot;color:#b4960a;&quot;&gt;)&lt;/span&gt;&lt;span style=&quot;color:#0e4a8e;&quot;&gt;}&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;&quot;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;)&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;        &lt;/span&gt;&lt;span style=&quot;color:#0033b3;&quot;&gt;return False&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#0033b3;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#0033b3;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#0033b3;&quot;&gt;def &lt;/span&gt;&lt;span style=&quot;color:#00627a;&quot;&gt;get_rejections_and_send_email&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;user&lt;/span&gt;: &lt;span style=&quot;color:#000000;&quot;&gt;User&lt;/span&gt;, &lt;span style=&quot;color:#000000;&quot;&gt;params&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;)&lt;/span&gt;:&lt;br&gt;    &lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;&quot;&quot;&quot;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    Получает отсечения и отправляет email с отчетом.&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    Args:&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;        user: Объект пользователя&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    &quot;&quot;&quot;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;epk_id &lt;/span&gt;= &lt;span style=&quot;color:#000000;&quot;&gt;user&lt;/span&gt;.variables.get&lt;span style=&quot;color:#3f9101;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;&quot;epk_id&quot;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;)&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;clust_id &lt;/span&gt;= &lt;span style=&quot;color:#000000;&quot;&gt;user&lt;/span&gt;.variables.get&lt;span style=&quot;color:#3f9101;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;&quot;clust_id&quot;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;)&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;bpIds_with_clusters &lt;/span&gt;= &lt;span style=&quot;color:#3f9101;&quot;&gt;[]&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color:#0033b3;&quot;&gt;if &lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;clust_id&lt;/span&gt;:&lt;br&gt;        log&lt;span style=&quot;color:#3f9101;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;f&quot;*********clust_id: &lt;/span&gt;&lt;span style=&quot;color:#0e4a8e;&quot;&gt;{&lt;/span&gt;&lt;span style=&quot;color:#000080;&quot;&gt;str&lt;/span&gt;&lt;span style=&quot;color:#b4960a;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;clust_id&lt;/span&gt;&lt;span style=&quot;color:#b4960a;&quot;&gt;)&lt;/span&gt;&lt;span style=&quot;color:#0e4a8e;&quot;&gt;}&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;&quot;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;)&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;        &lt;/span&gt;&lt;span style=&quot;color:#0033b3;&quot;&gt;for &lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;cluster &lt;/span&gt;&lt;span style=&quot;color:#0033b3;&quot;&gt;in &lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;clust_id&lt;/span&gt;:&lt;br&gt;            log&lt;span style=&quot;color:#3f9101;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;f&quot;********* Отправляем запрос  - cluster: &lt;/span&gt;&lt;span style=&quot;color:#0e4a8e;&quot;&gt;{&lt;/span&gt;&lt;span style=&quot;color:#000080;&quot;&gt;str&lt;/span&gt;&lt;span style=&quot;color:#b4960a;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;cluster&lt;/span&gt;&lt;span style=&quot;color:#b4960a;&quot;&gt;)&lt;/span&gt;&lt;span style=&quot;color:#0e4a8e;&quot;&gt;}&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;, ЕПК: &lt;/span&gt;&lt;span style=&quot;color:#0e4a8e;&quot;&gt;{&lt;/span&gt;&lt;span style=&quot;color:#000080;&quot;&gt;str&lt;/span&gt;&lt;span style=&quot;color:#b4960a;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;epk_id&lt;/span&gt;&lt;span style=&quot;color:#b4960a;&quot;&gt;)&lt;/span&gt;&lt;span style=&quot;color:#0e4a8e;&quot;&gt;}&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;&quot;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;)&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;            &lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;cluster_bpIds &lt;/span&gt;= send_request&lt;span style=&quot;color:#3f9101;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;epk_id&lt;/span&gt;, &lt;span style=&quot;color:#000000;&quot;&gt;cluster&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;)&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;            &lt;/span&gt;&lt;span style=&quot;color:#0033b3;&quot;&gt;if &lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;cluster_bpIds&lt;/span&gt;:&lt;br&gt;                log&lt;span style=&quot;color:#3f9101;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;f&quot;*********cluster_bpIds: &lt;/span&gt;&lt;span style=&quot;color:#0e4a8e;&quot;&gt;{&lt;/span&gt;&lt;span style=&quot;color:#000080;&quot;&gt;str&lt;/span&gt;&lt;span style=&quot;color:#b4960a;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;cluster_bpIds&lt;/span&gt;&lt;span style=&quot;color:#b4960a;&quot;&gt;)&lt;/span&gt;&lt;span style=&quot;color:#0e4a8e;&quot;&gt;}&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;&quot;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;)&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;                &lt;/span&gt;&lt;span style=&quot;color:#0033b3;&quot;&gt;for &lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;bpId &lt;/span&gt;&lt;span style=&quot;color:#0033b3;&quot;&gt;in &lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;cluster_bpIds&lt;/span&gt;:&lt;br&gt;                    &lt;span style=&quot;color:#000000;&quot;&gt;bpIds_with_clusters&lt;/span&gt;.append&lt;span style=&quot;color:#3f9101;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#0e4a8e;&quot;&gt;{&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#0e4a8e;&quot;&gt;                        &lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;&#39;bpId&#39;&lt;/span&gt;: &lt;span style=&quot;color:#000000;&quot;&gt;bpId&lt;/span&gt;,&lt;br&gt;                        &lt;span style=&quot;color:#067d17;&quot;&gt;&#39;cluster&#39;&lt;/span&gt;: &lt;span style=&quot;color:#000000;&quot;&gt;cluster&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;                    &lt;/span&gt;&lt;span style=&quot;color:#0e4a8e;&quot;&gt;}&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;)&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color:#0033b3;&quot;&gt;if &lt;/span&gt;&lt;span style=&quot;color:#000080;&quot;&gt;len&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;bpIds_with_clusters&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;) &lt;/span&gt;&amp;gt; &lt;span style=&quot;color:#1750eb;&quot;&gt;0&lt;/span&gt;:&lt;br&gt;        log&lt;span style=&quot;color:#3f9101;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;f&quot;*********bpIds_with_clusters: &lt;/span&gt;&lt;span style=&quot;color:#0e4a8e;&quot;&gt;{&lt;/span&gt;&lt;span style=&quot;color:#000080;&quot;&gt;str&lt;/span&gt;&lt;span style=&quot;color:#b4960a;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;bpIds_with_clusters&lt;/span&gt;&lt;span style=&quot;color:#b4960a;&quot;&gt;)&lt;/span&gt;&lt;span style=&quot;color:#0e4a8e;&quot;&gt;}&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;&quot;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;)&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;        &lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;error_codes &lt;/span&gt;= get_error_code&lt;span style=&quot;color:#3f9101;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;bpIds_with_clusters&lt;/span&gt;, &lt;span style=&quot;color:#000000;&quot;&gt;epk_id&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;)&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;        &lt;/span&gt;&lt;span style=&quot;color:#0033b3;&quot;&gt;if &lt;/span&gt;&lt;span style=&quot;color:#000080;&quot;&gt;len&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;error_codes&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;) &lt;/span&gt;&amp;gt; &lt;span style=&quot;color:#1750eb;&quot;&gt;0&lt;/span&gt;:&lt;br&gt;            &lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;# Сохраняем коды ошибок в файл&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;            &lt;/span&gt;&lt;span style=&quot;color:#0033b3;&quot;&gt;if &lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;epk_id &lt;/span&gt;== &lt;span style=&quot;color:#067d17;&quot;&gt;&#39;7777777777777777777&#39;&lt;/span&gt;:&lt;br&gt;                &lt;span style=&quot;color:#000000;&quot;&gt;user&lt;/span&gt;.variables.set&lt;span style=&quot;color:#3f9101;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;&quot;count_errors&quot;&lt;/span&gt;, &lt;span style=&quot;color:#067d17;&quot;&gt;&quot;0&quot;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;)&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;                &lt;/span&gt;log&lt;span style=&quot;color:#3f9101;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;f&quot;*********Используем заглушку для ЕПК 7777777777777777777: &lt;/span&gt;&lt;span style=&quot;color:#0e4a8e;&quot;&gt;{&lt;/span&gt;&lt;span style=&quot;color:#000080;&quot;&gt;str&lt;/span&gt;&lt;span style=&quot;color:#b4960a;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;error_codes&lt;/span&gt;&lt;span style=&quot;color:#b4960a;&quot;&gt;)&lt;/span&gt;&lt;span style=&quot;color:#0e4a8e;&quot;&gt;}&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;&quot;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;)&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;            &lt;/span&gt;&lt;span style=&quot;color:#0033b3;&quot;&gt;else&lt;/span&gt;:&lt;br&gt;                &lt;span style=&quot;color:#000000;&quot;&gt;user&lt;/span&gt;.variables.set&lt;span style=&quot;color:#3f9101;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;&quot;count_errors&quot;&lt;/span&gt;, &lt;span style=&quot;color:#000080;&quot;&gt;str&lt;/span&gt;&lt;span style=&quot;color:#0e4a8e;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#000080;&quot;&gt;len&lt;/span&gt;&lt;span style=&quot;color:#b4960a;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;error_codes&lt;/span&gt;&lt;span style=&quot;color:#b4960a;&quot;&gt;)&lt;/span&gt;&lt;span style=&quot;color:#0e4a8e;&quot;&gt;)&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;)&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;                &lt;/span&gt;log&lt;span style=&quot;color:#3f9101;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;f&quot;*********Количество полученных отсечений: &lt;/span&gt;&lt;span style=&quot;color:#0e4a8e;&quot;&gt;{&lt;/span&gt;&lt;span style=&quot;color:#000080;&quot;&gt;str&lt;/span&gt;&lt;span style=&quot;color:#b4960a;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;error_codes&lt;/span&gt;&lt;span style=&quot;color:#b4960a;&quot;&gt;)&lt;/span&gt;&lt;span style=&quot;color:#0e4a8e;&quot;&gt;}&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;&quot;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;)&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;            &lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;user_email &lt;/span&gt;= prepare_email_to_user&lt;span style=&quot;color:#3f9101;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;params&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;)&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;            &lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;result &lt;/span&gt;= process_and_save_errors_to_excel&lt;span style=&quot;color:#3f9101;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;error_codes&lt;/span&gt;, &lt;span style=&quot;color:#000000;&quot;&gt;epk_id&lt;/span&gt;, &lt;span style=&quot;color:#000000;&quot;&gt;user_email&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;)&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;            &lt;/span&gt;&lt;span style=&quot;color:#0033b3;&quot;&gt;if &lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;result&lt;/span&gt;:&lt;br&gt;                &lt;span style=&quot;color:#0033b3;&quot;&gt;if &lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;result &lt;/span&gt;== &lt;span style=&quot;color:#067d17;&quot;&gt;&quot;email_sent&quot;&lt;/span&gt;:&lt;br&gt;                    log&lt;span style=&quot;color:#3f9101;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;f&quot;Excel отчет отправлен по почте пользователю &lt;/span&gt;&lt;span style=&quot;color:#0e4a8e;&quot;&gt;{&lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;user_email&lt;/span&gt;&lt;span style=&quot;color:#0e4a8e;&quot;&gt;}&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;&quot;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;)&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;                    &lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;user&lt;/span&gt;.variables.set&lt;span style=&quot;color:#3f9101;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;&quot;success_email&quot;&lt;/span&gt;, &lt;span style=&quot;color:#067d17;&quot;&gt;&quot;1&quot;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;)&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;                &lt;/span&gt;&lt;span style=&quot;color:#0033b3;&quot;&gt;else&lt;/span&gt;:&lt;br&gt;                    &lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;#log(f&quot;Excel отчет создан: {result}&quot;)&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;                    &lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;user&lt;/span&gt;.variables.set&lt;span style=&quot;color:#3f9101;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;&quot;success_email&quot;&lt;/span&gt;, &lt;span style=&quot;color:#067d17;&quot;&gt;&quot;0&quot;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;)&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;            &lt;/span&gt;&lt;span style=&quot;color:#0033b3;&quot;&gt;else&lt;/span&gt;:&lt;br&gt;                log&lt;span style=&quot;color:#3f9101;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;&quot;Не удалось создать Excel отчет или отправить его по почте&quot;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;)&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;                &lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;user&lt;/span&gt;.variables.set&lt;span style=&quot;color:#3f9101;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;&quot;success_email&quot;&lt;/span&gt;, &lt;span style=&quot;color:#067d17;&quot;&gt;&quot;0&quot;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;)&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;        &lt;/span&gt;&lt;span style=&quot;color:#0033b3;&quot;&gt;else&lt;/span&gt;:&lt;br&gt;            &lt;span style=&quot;color:#000000;&quot;&gt;user&lt;/span&gt;.variables.set&lt;span style=&quot;color:#3f9101;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;&quot;count_errors&quot;&lt;/span&gt;, &lt;span style=&quot;color:#067d17;&quot;&gt;&quot;0&quot;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;)&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color:#0033b3;&quot;&gt;else&lt;/span&gt;:&lt;br&gt;        &lt;span style=&quot;color:#000000;&quot;&gt;user&lt;/span&gt;.variables.set&lt;span style=&quot;color:#3f9101;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;&quot;count_errors&quot;&lt;/span&gt;, &lt;span style=&quot;color:#067d17;&quot;&gt;&quot;0&quot;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;)&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color:#0033b3;&quot;&gt;return &lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;&#39;обращение в поддержку&#39;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;# Создаем необходимые директории при запуске модуля&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#0033b3;&quot;&gt;def &lt;/span&gt;&lt;span style=&quot;color:#00627a;&quot;&gt;create_required_directories&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;()&lt;/span&gt;:&lt;br&gt;    &lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;&quot;&quot;&quot;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    Создает необходимые директории для работы модуля.&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    &quot;&quot;&quot;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color:#0033b3;&quot;&gt;try&lt;/span&gt;:&lt;br&gt;        &lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;# Директория для сохранения JSON файлов с ошибками&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;        &lt;/span&gt;os.makedirs&lt;span style=&quot;color:#3f9101;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;&#39;app/basic_entities/utils/rejections/error_codes&#39;&lt;/span&gt;, &lt;span style=&quot;color:#660099;&quot;&gt;exist_ok&lt;/span&gt;=&lt;span style=&quot;color:#0033b3;&quot;&gt;True&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;)&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;        &lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;# Директория для сохранения Excel отчетов&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;        &lt;/span&gt;os.makedirs&lt;span style=&quot;color:#3f9101;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;&#39;app/basic_entities/utils/rejections/excel_reports&#39;&lt;/span&gt;, &lt;span style=&quot;color:#660099;&quot;&gt;exist_ok&lt;/span&gt;=&lt;span style=&quot;color:#0033b3;&quot;&gt;True&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;)&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;        &lt;/span&gt;log&lt;span style=&quot;color:#3f9101;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;&quot;Необходимые директории созданы&quot;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;)&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color:#0033b3;&quot;&gt;except &lt;/span&gt;&lt;span style=&quot;color:#000080;&quot;&gt;Exception &lt;/span&gt;&lt;span style=&quot;color:#0033b3;&quot;&gt;as &lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;e&lt;/span&gt;:&lt;br&gt;        log&lt;span style=&quot;color:#3f9101;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;f&quot;Ошибка при создании директорий: &lt;/span&gt;&lt;span style=&quot;color:#0e4a8e;&quot;&gt;{&lt;/span&gt;&lt;span style=&quot;color:#000080;&quot;&gt;str&lt;/span&gt;&lt;span style=&quot;color:#b4960a;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;e&lt;/span&gt;&lt;span style=&quot;color:#b4960a;&quot;&gt;)&lt;/span&gt;&lt;span style=&quot;color:#0e4a8e;&quot;&gt;}&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;&quot;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;)&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#0033b3;&quot;&gt;def &lt;/span&gt;&lt;span style=&quot;color:#00627a;&quot;&gt;get_error_codes_from_excel&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;() &lt;/span&gt;-&amp;gt; &lt;span style=&quot;color:#000080;&quot;&gt;dict&lt;/span&gt;:&lt;br&gt;    &lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;&quot;&quot;&quot;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    Читает Excel файл-справочник с кодами ошибок.&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    Столбцы:&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    C (3) - error_code (код проверки)&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    D (4) - check_name (наименование проверки)&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    F (6) - result (инструмент исправления проверки)&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    Returns:&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;        dict: Словарь в формате:&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;        {&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;            &#39;error_code&#39;: {&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;                &#39;check_name&#39;: str,&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;                &#39;result&#39;: str&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;            }&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;        }&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    &quot;&quot;&quot;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color:#0033b3;&quot;&gt;try&lt;/span&gt;:&lt;br&gt;        &lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;# Путь к Excel файлу&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;        &lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;file_path &lt;/span&gt;= &lt;span style=&quot;color:#067d17;&quot;&gt;&#39;app/basic_entities/utils/rejections/error_codes.xlsx&#39;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;        &lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;# Проверяем существование файла&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;        &lt;/span&gt;&lt;span style=&quot;color:#0033b3;&quot;&gt;if not &lt;/span&gt;os.path.exists&lt;span style=&quot;color:#3f9101;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;file_path&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;)&lt;/span&gt;:&lt;br&gt;            log&lt;span style=&quot;color:#3f9101;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;f&quot;Файл-справочник &lt;/span&gt;&lt;span style=&quot;color:#0e4a8e;&quot;&gt;{&lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;file_path&lt;/span&gt;&lt;span style=&quot;color:#0e4a8e;&quot;&gt;}&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt; не найден&quot;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;)&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;            &lt;/span&gt;&lt;span style=&quot;color:#0033b3;&quot;&gt;return &lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;{}&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;        &lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;# Читаем Excel файл, используя конкретные столбцы C, D и F&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;        &lt;/span&gt;&lt;span style=&quot;color:#0033b3;&quot;&gt;try&lt;/span&gt;:&lt;br&gt;            &lt;span style=&quot;color:#000000;&quot;&gt;df &lt;/span&gt;= pd.read_excel&lt;span style=&quot;color:#3f9101;&quot;&gt;(&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;                &lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;file_path&lt;/span&gt;,&lt;br&gt;                &lt;span style=&quot;color:#660099;&quot;&gt;usecols&lt;/span&gt;=&lt;span style=&quot;color:#0e4a8e;&quot;&gt;[&lt;/span&gt;&lt;span style=&quot;color:#1750eb;&quot;&gt;2&lt;/span&gt;, &lt;span style=&quot;color:#1750eb;&quot;&gt;3&lt;/span&gt;, &lt;span style=&quot;color:#1750eb;&quot;&gt;5&lt;/span&gt;&lt;span style=&quot;color:#0e4a8e;&quot;&gt;]&lt;/span&gt;,  &lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;# Индексы столбцов (C=2, D=3, F=5)&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;                &lt;/span&gt;&lt;span style=&quot;color:#660099;&quot;&gt;header&lt;/span&gt;=&lt;span style=&quot;color:#1750eb;&quot;&gt;0  &lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;# Первая строка содержит заголовки&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;            &lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;)&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;        &lt;/span&gt;&lt;span style=&quot;color:#0033b3;&quot;&gt;except &lt;/span&gt;&lt;span style=&quot;color:#000080;&quot;&gt;Exception &lt;/span&gt;&lt;span style=&quot;color:#0033b3;&quot;&gt;as &lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;e&lt;/span&gt;:&lt;br&gt;            log&lt;span style=&quot;color:#3f9101;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;f&quot;Ошибка при чтении файла-справочника с указанными столбцами: &lt;/span&gt;&lt;span style=&quot;color:#0e4a8e;&quot;&gt;{&lt;/span&gt;&lt;span style=&quot;color:#000080;&quot;&gt;str&lt;/span&gt;&lt;span style=&quot;color:#b4960a;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;e&lt;/span&gt;&lt;span style=&quot;color:#b4960a;&quot;&gt;)&lt;/span&gt;&lt;span style=&quot;color:#0e4a8e;&quot;&gt;}&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;&quot;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;)&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;            &lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;# Пробуем прочитать весь файл&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;            &lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;df &lt;/span&gt;= pd.read_excel&lt;span style=&quot;color:#3f9101;&quot;&gt;(&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;                &lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;file_path&lt;/span&gt;,&lt;br&gt;                &lt;span style=&quot;color:#660099;&quot;&gt;header&lt;/span&gt;=&lt;span style=&quot;color:#1750eb;&quot;&gt;0&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#1750eb;&quot;&gt;            &lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;)&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;        &lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;# Создаем словарь&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;        &lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;error_codes &lt;/span&gt;= &lt;span style=&quot;color:#3f9101;&quot;&gt;{}&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;        &lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;# Если у нас есть хотя бы 3 столбца&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;        &lt;/span&gt;&lt;span style=&quot;color:#0033b3;&quot;&gt;if &lt;/span&gt;&lt;span style=&quot;color:#000080;&quot;&gt;len&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;df&lt;/span&gt;.columns&lt;span style=&quot;color:#3f9101;&quot;&gt;) &lt;/span&gt;&amp;gt;= &lt;span style=&quot;color:#1750eb;&quot;&gt;3&lt;/span&gt;:&lt;br&gt;            &lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;# Проходим по всем строкам&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;            &lt;/span&gt;&lt;span style=&quot;color:#0033b3;&quot;&gt;for &lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;index&lt;/span&gt;, &lt;span style=&quot;color:#000000;&quot;&gt;row &lt;/span&gt;&lt;span style=&quot;color:#0033b3;&quot;&gt;in &lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;df&lt;/span&gt;.iterrows&lt;span style=&quot;color:#3f9101;&quot;&gt;()&lt;/span&gt;:&lt;br&gt;                &lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;# Получаем значения и удаляем лишние пробелы&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;                &lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;error_code &lt;/span&gt;= &lt;span style=&quot;color:#000080;&quot;&gt;str&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;row&lt;/span&gt;.iloc&lt;span style=&quot;color:#0e4a8e;&quot;&gt;[&lt;/span&gt;&lt;span style=&quot;color:#1750eb;&quot;&gt;0&lt;/span&gt;&lt;span style=&quot;color:#0e4a8e;&quot;&gt;]&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;)&lt;/span&gt;.strip&lt;span style=&quot;color:#3f9101;&quot;&gt;() &lt;/span&gt;&lt;span style=&quot;color:#0033b3;&quot;&gt;if not &lt;/span&gt;pd.isna&lt;span style=&quot;color:#3f9101;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;row&lt;/span&gt;.iloc&lt;span style=&quot;color:#0e4a8e;&quot;&gt;[&lt;/span&gt;&lt;span style=&quot;color:#1750eb;&quot;&gt;0&lt;/span&gt;&lt;span style=&quot;color:#0e4a8e;&quot;&gt;]&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;) &lt;/span&gt;&lt;span style=&quot;color:#0033b3;&quot;&gt;else &lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;&quot;&quot;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;                &lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;check_name &lt;/span&gt;= &lt;span style=&quot;color:#000080;&quot;&gt;str&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;row&lt;/span&gt;.iloc&lt;span style=&quot;color:#0e4a8e;&quot;&gt;[&lt;/span&gt;&lt;span style=&quot;color:#1750eb;&quot;&gt;1&lt;/span&gt;&lt;span style=&quot;color:#0e4a8e;&quot;&gt;]&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;)&lt;/span&gt;.strip&lt;span style=&quot;color:#3f9101;&quot;&gt;() &lt;/span&gt;&lt;span style=&quot;color:#0033b3;&quot;&gt;if not &lt;/span&gt;pd.isna&lt;span style=&quot;color:#3f9101;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;row&lt;/span&gt;.iloc&lt;span style=&quot;color:#0e4a8e;&quot;&gt;[&lt;/span&gt;&lt;span style=&quot;color:#1750eb;&quot;&gt;1&lt;/span&gt;&lt;span style=&quot;color:#0e4a8e;&quot;&gt;]&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;) &lt;/span&gt;&lt;span style=&quot;color:#0033b3;&quot;&gt;else &lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;&quot;&quot;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;                &lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;result &lt;/span&gt;= &lt;span style=&quot;color:#000080;&quot;&gt;str&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;row&lt;/span&gt;.iloc&lt;span style=&quot;color:#0e4a8e;&quot;&gt;[&lt;/span&gt;&lt;span style=&quot;color:#1750eb;&quot;&gt;2&lt;/span&gt;&lt;span style=&quot;color:#0e4a8e;&quot;&gt;]&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;)&lt;/span&gt;.strip&lt;span style=&quot;color:#3f9101;&quot;&gt;() &lt;/span&gt;&lt;span style=&quot;color:#0033b3;&quot;&gt;if not &lt;/span&gt;pd.isna&lt;span style=&quot;color:#3f9101;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;row&lt;/span&gt;.iloc&lt;span style=&quot;color:#0e4a8e;&quot;&gt;[&lt;/span&gt;&lt;span style=&quot;color:#1750eb;&quot;&gt;2&lt;/span&gt;&lt;span style=&quot;color:#0e4a8e;&quot;&gt;]&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;) &lt;/span&gt;&lt;span style=&quot;color:#0033b3;&quot;&gt;else &lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;&quot;&quot;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;                &lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;# Пропускаем строки с пустым кодом ошибки&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;                &lt;/span&gt;&lt;span style=&quot;color:#0033b3;&quot;&gt;if not &lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;error_code&lt;/span&gt;:&lt;br&gt;                    &lt;span style=&quot;color:#0033b3;&quot;&gt;continue&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#0033b3;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#0033b3;&quot;&gt;                &lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;# Добавляем в словарь&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;                &lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;error_codes&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;[&lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;error_code&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;] &lt;/span&gt;= &lt;span style=&quot;color:#3f9101;&quot;&gt;{&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;                    &lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;&#39;check_name&#39;&lt;/span&gt;: &lt;span style=&quot;color:#000000;&quot;&gt;check_name&lt;/span&gt;,&lt;br&gt;                    &lt;span style=&quot;color:#067d17;&quot;&gt;&#39;result&#39;&lt;/span&gt;: &lt;span style=&quot;color:#000000;&quot;&gt;result&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;                &lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;}&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;        &lt;/span&gt;&lt;span style=&quot;color:#0033b3;&quot;&gt;else&lt;/span&gt;:&lt;br&gt;            log&lt;span style=&quot;color:#3f9101;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;&quot;В файле-справочнике недостаточно столбцов&quot;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;)&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;            &lt;/span&gt;&lt;span style=&quot;color:#0033b3;&quot;&gt;return &lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;{}&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;        &lt;/span&gt;log&lt;span style=&quot;color:#3f9101;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;f&quot;Загружено &lt;/span&gt;&lt;span style=&quot;color:#0e4a8e;&quot;&gt;{&lt;/span&gt;&lt;span style=&quot;color:#000080;&quot;&gt;len&lt;/span&gt;&lt;span style=&quot;color:#b4960a;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;error_codes&lt;/span&gt;&lt;span style=&quot;color:#b4960a;&quot;&gt;)&lt;/span&gt;&lt;span style=&quot;color:#0e4a8e;&quot;&gt;}&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt; кодов ошибок из файла-справочника&quot;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;)&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;        &lt;/span&gt;log&lt;span style=&quot;color:#3f9101;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;f&quot;Создан словарь отсечений с кодами ошибок: &lt;/span&gt;&lt;span style=&quot;color:#0e4a8e;&quot;&gt;{&lt;/span&gt;&lt;span style=&quot;color:#000080;&quot;&gt;str&lt;/span&gt;&lt;span style=&quot;color:#bc0ba2;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;error_codes&lt;/span&gt;&lt;span style=&quot;color:#bc0ba2;&quot;&gt;)&lt;/span&gt;&lt;span style=&quot;color:#b4960a;&quot;&gt;[&lt;/span&gt;:&lt;span style=&quot;color:#1750eb;&quot;&gt;150&lt;/span&gt;&lt;span style=&quot;color:#b4960a;&quot;&gt;]&lt;/span&gt;&lt;span style=&quot;color:#0e4a8e;&quot;&gt;}&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;&quot;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;)&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;        &lt;/span&gt;&lt;span style=&quot;color:#0033b3;&quot;&gt;return &lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;error_codes&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color:#0033b3;&quot;&gt;except &lt;/span&gt;&lt;span style=&quot;color:#000080;&quot;&gt;Exception &lt;/span&gt;&lt;span style=&quot;color:#0033b3;&quot;&gt;as &lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;e&lt;/span&gt;:&lt;br&gt;        log&lt;span style=&quot;color:#3f9101;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;f&quot;Ошибка при чтении файла-справочника: &lt;/span&gt;&lt;span style=&quot;color:#0e4a8e;&quot;&gt;{&lt;/span&gt;&lt;span style=&quot;color:#000080;&quot;&gt;str&lt;/span&gt;&lt;span style=&quot;color:#b4960a;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;e&lt;/span&gt;&lt;span style=&quot;color:#b4960a;&quot;&gt;)&lt;/span&gt;&lt;span style=&quot;color:#0e4a8e;&quot;&gt;}&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;&quot;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;)&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;        &lt;/span&gt;&lt;span style=&quot;color:#0033b3;&quot;&gt;return &lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;{}&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#0033b3;&quot;&gt;def &lt;/span&gt;&lt;span style=&quot;color:#00627a;&quot;&gt;create_excel_from_dicts&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;error_codes&lt;/span&gt;: &lt;span style=&quot;color:#000080;&quot;&gt;dict&lt;/span&gt;, &lt;span style=&quot;color:#000000;&quot;&gt;api_errors&lt;/span&gt;: &lt;span style=&quot;color:#000080;&quot;&gt;list&lt;/span&gt;, &lt;span style=&quot;color:#000000;&quot;&gt;epk_id&lt;/span&gt;: &lt;span style=&quot;color:#000080;&quot;&gt;str&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;) &lt;/span&gt;-&amp;gt; &lt;span style=&quot;color:#000080;&quot;&gt;tuple&lt;/span&gt;:&lt;br&gt;    &lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;&quot;&quot;&quot;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    Создает Excel файл на основе данных из API и справочника кодов ошибок.&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    Args:&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;        error_codes: Словарь с кодами ошибок из справочника&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;        api_errors: Список ошибок, полученных из API&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;        epk_id: Идентификатор организации&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    Returns:&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;        tuple: (Excel файл, закодированный в base64, HTML представление отчета)&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    &quot;&quot;&quot;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;epk_masked &lt;/span&gt;= &lt;span style=&quot;color:#000000;&quot;&gt;epk_id&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;[&lt;/span&gt;:&lt;span style=&quot;color:#1750eb;&quot;&gt;4&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;] &lt;/span&gt;+ &lt;span style=&quot;color:#067d17;&quot;&gt;&quot;****&quot; &lt;/span&gt;+ &lt;span style=&quot;color:#000000;&quot;&gt;epk_id&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;[&lt;/span&gt;-&lt;span style=&quot;color:#1750eb;&quot;&gt;4&lt;/span&gt;:&lt;span style=&quot;color:#3f9101;&quot;&gt;]&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color:#0033b3;&quot;&gt;try&lt;/span&gt;:&lt;br&gt;        &lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;# Создаем DataFrame для отчета с ошибками&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;        &lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;report_data &lt;/span&gt;= &lt;span style=&quot;color:#3f9101;&quot;&gt;[]&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;        &lt;/span&gt;&lt;span style=&quot;color:#0033b3;&quot;&gt;for &lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;error &lt;/span&gt;&lt;span style=&quot;color:#0033b3;&quot;&gt;in &lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;api_errors&lt;/span&gt;:&lt;br&gt;            &lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;# Получаем код ошибки&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;            &lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;error_code &lt;/span&gt;= &lt;span style=&quot;color:#000000;&quot;&gt;error&lt;/span&gt;.get&lt;span style=&quot;color:#3f9101;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;&#39;code&#39;&lt;/span&gt;, &lt;span style=&quot;color:#067d17;&quot;&gt;&#39;&#39;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;)&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;            &lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;# Получаем дополнительную информацию из словаря error_codes&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;            &lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;error_info &lt;/span&gt;= &lt;span style=&quot;color:#000000;&quot;&gt;error_codes&lt;/span&gt;.get&lt;span style=&quot;color:#3f9101;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;error_code&lt;/span&gt;, &lt;span style=&quot;color:#0e4a8e;&quot;&gt;{}&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;)&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;            &lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;check_name &lt;/span&gt;= &lt;span style=&quot;color:#000000;&quot;&gt;error_info&lt;/span&gt;.get&lt;span style=&quot;color:#3f9101;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;&#39;check_name&#39;&lt;/span&gt;, &lt;span style=&quot;color:#067d17;&quot;&gt;&#39;&#39;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;)&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;            &lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;result &lt;/span&gt;= &lt;span style=&quot;color:#000000;&quot;&gt;error_info&lt;/span&gt;.get&lt;span style=&quot;color:#3f9101;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;&#39;result&#39;&lt;/span&gt;, &lt;span style=&quot;color:#067d17;&quot;&gt;&#39;&#39;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;)&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;            &lt;/span&gt;&lt;span style=&quot;color:#0033b3;&quot;&gt;if &lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;result &lt;/span&gt;== &lt;span style=&quot;color:#067d17;&quot;&gt;&quot;&quot;&lt;/span&gt;:&lt;br&gt;                &lt;span style=&quot;color:#000000;&quot;&gt;result &lt;/span&gt;= &lt;span style=&quot;color:#067d17;&quot;&gt;r&quot;&amp;lt;p&amp;gt;Для данного отсечения не найден инструмент для исправления. Если у вас остались вопросы, обратитесь в &amp;lt;a href=&#39;https://sberfriend.sberbank.ru/sberfriend/#/application/93D17F30A87B46A78B91CCBDCC37C6F2&#39;&amp;gt;службу поддержки&amp;lt;/a&amp;gt;.&amp;lt;/p&amp;gt;&quot;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;            &lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;# Получаем кластер&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;            &lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;cluster &lt;/span&gt;= &lt;span style=&quot;color:#000000;&quot;&gt;error&lt;/span&gt;.get&lt;span style=&quot;color:#3f9101;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;&#39;cluster&#39;&lt;/span&gt;, &lt;span style=&quot;color:#067d17;&quot;&gt;&#39;&#39;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;)&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;            &lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;cluster &lt;/span&gt;= get_human_readable_product_name&lt;span style=&quot;color:#3f9101;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;cluster&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;)&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;            &lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;# Добавляем только нужные поля в отчет&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;            &lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;report_data&lt;/span&gt;.append&lt;span style=&quot;color:#3f9101;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#0e4a8e;&quot;&gt;{&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#0e4a8e;&quot;&gt;                &lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;&#39;Код ошибки&#39;&lt;/span&gt;: &lt;span style=&quot;color:#000000;&quot;&gt;error_code&lt;/span&gt;,&lt;br&gt;                &lt;span style=&quot;color:#067d17;&quot;&gt;&#39;Наименование проверки&#39;&lt;/span&gt;: &lt;span style=&quot;color:#000000;&quot;&gt;check_name&lt;/span&gt;,&lt;br&gt;                &lt;span style=&quot;color:#067d17;&quot;&gt;&#39;Инструмент исправления&#39;&lt;/span&gt;: &lt;span style=&quot;color:#000000;&quot;&gt;result&lt;/span&gt;,&lt;br&gt;                &lt;span style=&quot;color:#067d17;&quot;&gt;&#39;Продукт&#39;&lt;/span&gt;: &lt;span style=&quot;color:#000000;&quot;&gt;cluster&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;            &lt;/span&gt;&lt;span style=&quot;color:#0e4a8e;&quot;&gt;}&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;)&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;        &lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;# Удаляем дубликаты из отчета&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;        &lt;/span&gt;&lt;span style=&quot;color:#0033b3;&quot;&gt;if &lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;report_data&lt;/span&gt;:&lt;br&gt;            &lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;# Создаем DataFrame из списка словарей&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;            &lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;df_report &lt;/span&gt;= pd.DataFrame&lt;span style=&quot;color:#3f9101;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;report_data&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;)&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;            &lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;# Удаляем полностью идентичные записи&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;            &lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;df_report &lt;/span&gt;= &lt;span style=&quot;color:#000000;&quot;&gt;df_report&lt;/span&gt;.drop_duplicates&lt;span style=&quot;color:#3f9101;&quot;&gt;()&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;            &lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;# Сортируем по коду ошибки и кластеру для лучшей читаемости&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;            &lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;df_report &lt;/span&gt;= &lt;span style=&quot;color:#000000;&quot;&gt;df_report&lt;/span&gt;.sort_values&lt;span style=&quot;color:#3f9101;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#660099;&quot;&gt;by&lt;/span&gt;=&lt;span style=&quot;color:#0e4a8e;&quot;&gt;[&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;&#39;Продукт&#39;&lt;/span&gt;, &lt;span style=&quot;color:#067d17;&quot;&gt;&#39;Код ошибки&#39;&lt;/span&gt;&lt;span style=&quot;color:#0e4a8e;&quot;&gt;]&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;)&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;            &lt;/span&gt;log&lt;span style=&quot;color:#3f9101;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;f&quot;Удалено &lt;/span&gt;&lt;span style=&quot;color:#0e4a8e;&quot;&gt;{&lt;/span&gt;&lt;span style=&quot;color:#000080;&quot;&gt;len&lt;/span&gt;&lt;span style=&quot;color:#b4960a;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;report_data&lt;/span&gt;&lt;span style=&quot;color:#b4960a;&quot;&gt;) &lt;/span&gt;- &lt;span style=&quot;color:#000080;&quot;&gt;len&lt;/span&gt;&lt;span style=&quot;color:#b4960a;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;df_report&lt;/span&gt;&lt;span style=&quot;color:#b4960a;&quot;&gt;)&lt;/span&gt;&lt;span style=&quot;color:#0e4a8e;&quot;&gt;}&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt; дубликатов из отчета&quot;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;)&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;            &lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;# Создаем HTML представление отчета&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;            &lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;html_report &lt;/span&gt;= &lt;span style=&quot;color:#067d17;&quot;&gt;f&quot;&quot;&quot;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;            &amp;lt;!DOCTYPE html&amp;gt;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;            &amp;lt;html&amp;gt;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;            &amp;lt;head&amp;gt;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;                &amp;lt;meta charset=&quot;utf-8&quot;&amp;gt;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;                &amp;lt;title&amp;gt;Проверка клиента на доступность продукта в ЦКП для &lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;{&lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;epk_masked&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;}&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;&amp;lt;/title&amp;gt;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;                &amp;lt;style&amp;gt;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;                    body &lt;/span&gt;&lt;span style=&quot;color:#0037a6;&quot;&gt;{{&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt; font-family: Arial, sans-serif; margin: 20px; &lt;/span&gt;&lt;span style=&quot;color:#0037a6;&quot;&gt;}}&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;                    h1 &lt;/span&gt;&lt;span style=&quot;color:#0037a6;&quot;&gt;{{&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt; color: #003366; &lt;/span&gt;&lt;span style=&quot;color:#0037a6;&quot;&gt;}}&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;                    h2 &lt;/span&gt;&lt;span style=&quot;color:#0037a6;&quot;&gt;{{&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt; color: #0066cc; margin-top: 30px; &lt;/span&gt;&lt;span style=&quot;color:#0037a6;&quot;&gt;}}&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;                    table &lt;/span&gt;&lt;span style=&quot;color:#0037a6;&quot;&gt;{{&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt; border-collapse: collapse; width: 100%; margin-bottom: 30px; &lt;/span&gt;&lt;span style=&quot;color:#0037a6;&quot;&gt;}}&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;                    th, td &lt;/span&gt;&lt;span style=&quot;color:#0037a6;&quot;&gt;{{&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt; border: 1px solid #ddd; padding: 8px; text-align: left; &lt;/span&gt;&lt;span style=&quot;color:#0037a6;&quot;&gt;}}&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;                    th &lt;/span&gt;&lt;span style=&quot;color:#0037a6;&quot;&gt;{{&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt; background-color: #f2f2f2; color: #333; &lt;/span&gt;&lt;span style=&quot;color:#0037a6;&quot;&gt;}}&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;                    tr:nth-child(even) &lt;/span&gt;&lt;span style=&quot;color:#0037a6;&quot;&gt;{{&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt; background-color: #f9f9f9; &lt;/span&gt;&lt;span style=&quot;color:#0037a6;&quot;&gt;}}&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;                    .cluster-header &lt;/span&gt;&lt;span style=&quot;color:#0037a6;&quot;&gt;{{&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt; background-color: #e6f2ff; font-weight: bold; &lt;/span&gt;&lt;span style=&quot;color:#0037a6;&quot;&gt;}}&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;                &amp;lt;/style&amp;gt;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;            &amp;lt;/head&amp;gt;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;            &amp;lt;body&amp;gt;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;                &amp;lt;h1&amp;gt;Проверка клиента на доступность продукта в ЦКП для &lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;{&lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;epk_masked&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;}&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;&amp;lt;/h1&amp;gt;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;            &quot;&quot;&quot;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;            &lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;# Группируем по кластеру для лучшей читаемости&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;            &lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;grouped &lt;/span&gt;= &lt;span style=&quot;color:#000000;&quot;&gt;df_report&lt;/span&gt;.groupby&lt;span style=&quot;color:#3f9101;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;&#39;Продукт&#39;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;)&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;            &lt;/span&gt;&lt;span style=&quot;color:#0033b3;&quot;&gt;for &lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;cluster_name&lt;/span&gt;, &lt;span style=&quot;color:#000000;&quot;&gt;cluster_group &lt;/span&gt;&lt;span style=&quot;color:#0033b3;&quot;&gt;in &lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;grouped&lt;/span&gt;:&lt;br&gt;                &lt;span style=&quot;color:#000000;&quot;&gt;html_report &lt;/span&gt;+= &lt;span style=&quot;color:#067d17;&quot;&gt;f&quot;&quot;&quot;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;                &amp;lt;h2&amp;gt;Продукт: &lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;{&lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;cluster_name&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;}&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;&amp;lt;/h2&amp;gt;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;                &amp;lt;table&amp;gt;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;                    &amp;lt;tr&amp;gt;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;                        &amp;lt;th&amp;gt;Код&amp;lt;/th&amp;gt;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;                        &amp;lt;th&amp;gt;Наименование проверки&amp;lt;/th&amp;gt;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;                        &amp;lt;th&amp;gt;Инструмент исправления&amp;lt;/th&amp;gt;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;                    &amp;lt;/tr&amp;gt;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;                &quot;&quot;&quot;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;                &lt;/span&gt;&lt;span style=&quot;color:#0033b3;&quot;&gt;for &lt;/span&gt;_, &lt;span style=&quot;color:#000000;&quot;&gt;row &lt;/span&gt;&lt;span style=&quot;color:#0033b3;&quot;&gt;in &lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;cluster_group&lt;/span&gt;.iterrows&lt;span style=&quot;color:#3f9101;&quot;&gt;()&lt;/span&gt;:&lt;br&gt;                    &lt;span style=&quot;color:#000000;&quot;&gt;html_report &lt;/span&gt;+= &lt;span style=&quot;color:#067d17;&quot;&gt;f&quot;&quot;&quot;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;                    &amp;lt;tr&amp;gt;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;                        &amp;lt;td&amp;gt;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;{&lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;row&lt;/span&gt;&lt;span style=&quot;color:#0e4a8e;&quot;&gt;[&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;&#39;Код ошибки&#39;&lt;/span&gt;&lt;span style=&quot;color:#0e4a8e;&quot;&gt;]&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;}&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;&amp;lt;/td&amp;gt;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;                        &amp;lt;td&amp;gt;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;{&lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;row&lt;/span&gt;&lt;span style=&quot;color:#0e4a8e;&quot;&gt;[&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;&#39;Наименование проверки&#39;&lt;/span&gt;&lt;span style=&quot;color:#0e4a8e;&quot;&gt;]&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;}&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;&amp;lt;/td&amp;gt;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;                        &amp;lt;td&amp;gt;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;{&lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;row&lt;/span&gt;&lt;span style=&quot;color:#0e4a8e;&quot;&gt;[&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;&#39;Инструмент исправления&#39;&lt;/span&gt;&lt;span style=&quot;color:#0e4a8e;&quot;&gt;]&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;}&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;&amp;lt;/td&amp;gt;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;                    &amp;lt;/tr&amp;gt;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;                    &quot;&quot;&quot;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;                &lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;html_report &lt;/span&gt;+= &lt;span style=&quot;color:#067d17;&quot;&gt;&quot;&amp;lt;/table&amp;gt;&quot;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;            &lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;html_report &lt;/span&gt;+= &lt;span style=&quot;color:#067d17;&quot;&gt;&quot;&quot;&quot;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;            &amp;lt;p&amp;gt;Виртуальный ассистент сотрудника&amp;lt;/p&amp;gt;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;            &amp;lt;/body&amp;gt;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;            &amp;lt;/html&amp;gt;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;            &quot;&quot;&quot;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;        &lt;/span&gt;&lt;span style=&quot;color:#0033b3;&quot;&gt;else&lt;/span&gt;:&lt;br&gt;            &lt;span style=&quot;color:#000000;&quot;&gt;df_report &lt;/span&gt;= pd.DataFrame&lt;span style=&quot;color:#3f9101;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#660099;&quot;&gt;columns&lt;/span&gt;=&lt;span style=&quot;color:#0e4a8e;&quot;&gt;[&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;&#39;Код ошибки&#39;&lt;/span&gt;, &lt;span style=&quot;color:#067d17;&quot;&gt;&#39;Наименование проверки&#39;&lt;/span&gt;, &lt;span style=&quot;color:#067d17;&quot;&gt;&#39;Инструмент исправления&#39;&lt;/span&gt;, &lt;span style=&quot;color:#067d17;&quot;&gt;&#39;Продукт&#39;&lt;/span&gt;&lt;span style=&quot;color:#0e4a8e;&quot;&gt;]&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;)&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;            &lt;/span&gt;log&lt;span style=&quot;color:#3f9101;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;&quot;Отчет пуст, нет данных для обработки&quot;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;)&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;            &lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;html_report &lt;/span&gt;= &lt;span style=&quot;color:#067d17;&quot;&gt;f&quot;&quot;&quot;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;            &amp;lt;!DOCTYPE html&amp;gt;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;            &amp;lt;html&amp;gt;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;            &amp;lt;head&amp;gt;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;                &amp;lt;meta charset=&quot;utf-8&quot;&amp;gt;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;                &amp;lt;title&amp;gt;Проверка клиента на доступность продукта в ЦКП для &lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;{&lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;epk_masked&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;}&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;&amp;lt;/title&amp;gt;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;                &amp;lt;style&amp;gt;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;                    body &lt;/span&gt;&lt;span style=&quot;color:#0037a6;&quot;&gt;{{&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt; font-family: Arial, sans-serif; margin: 20px; &lt;/span&gt;&lt;span style=&quot;color:#0037a6;&quot;&gt;}}&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;                    h1 &lt;/span&gt;&lt;span style=&quot;color:#0037a6;&quot;&gt;{{&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt; color: #003366; &lt;/span&gt;&lt;span style=&quot;color:#0037a6;&quot;&gt;}}&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;                    p &lt;/span&gt;&lt;span style=&quot;color:#0037a6;&quot;&gt;{{&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt; color: #666; &lt;/span&gt;&lt;span style=&quot;color:#0037a6;&quot;&gt;}}&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;                &amp;lt;/style&amp;gt;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;            &amp;lt;/head&amp;gt;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;            &amp;lt;body&amp;gt;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;                &amp;lt;h1&amp;gt;Проверка клиента на доступность продукта в ЦКП для &lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;{&lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;epk_masked&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;}&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;&amp;lt;/h1&amp;gt;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;                &amp;lt;p&amp;gt;После проведения проверки по данному продукту, отсечений не выявлено. Если у вас возникли сложности или остались вопросы, пожалуйста, обратитесь в службу поддержки&amp;lt;/p&amp;gt;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;                &amp;lt;p&amp;gt;Виртуальный ассистент сотрудника&amp;lt;/p&amp;gt;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;            &amp;lt;/body&amp;gt;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;            &amp;lt;/html&amp;gt;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;            &quot;&quot;&quot;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;        &lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;# Создаем Excel-писатель&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;        &lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;output &lt;/span&gt;= io.BytesIO&lt;span style=&quot;color:#3f9101;&quot;&gt;()&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;        &lt;/span&gt;&lt;span style=&quot;color:#0033b3;&quot;&gt;with &lt;/span&gt;pd.ExcelWriter&lt;span style=&quot;color:#3f9101;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;output&lt;/span&gt;, &lt;span style=&quot;color:#660099;&quot;&gt;engine&lt;/span&gt;=&lt;span style=&quot;color:#067d17;&quot;&gt;&#39;xlsxwriter&#39;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;) &lt;/span&gt;&lt;span style=&quot;color:#0033b3;&quot;&gt;as &lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;writer&lt;/span&gt;:&lt;br&gt;            &lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;# Лист с отчетом&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;            &lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;df_report&lt;/span&gt;.to_excel&lt;span style=&quot;color:#3f9101;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;writer&lt;/span&gt;, &lt;span style=&quot;color:#660099;&quot;&gt;sheet_name&lt;/span&gt;=&lt;span style=&quot;color:#067d17;&quot;&gt;&#39;Отчет&#39;&lt;/span&gt;, &lt;span style=&quot;color:#660099;&quot;&gt;index&lt;/span&gt;=&lt;span style=&quot;color:#0033b3;&quot;&gt;False&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;)&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;            &lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;# Получаем объект workbook&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;            &lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;workbook &lt;/span&gt;= &lt;span style=&quot;color:#000000;&quot;&gt;writer&lt;/span&gt;.book&lt;br&gt;&lt;br&gt;            &lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;# Форматирование листа с отчетом&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;            &lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;worksheet &lt;/span&gt;= &lt;span style=&quot;color:#000000;&quot;&gt;writer&lt;/span&gt;.sheets&lt;span style=&quot;color:#3f9101;&quot;&gt;[&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;&#39;Отчет&#39;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;]&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;            &lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;# Устанавливаем ширину столбцов&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;            &lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;worksheet&lt;/span&gt;.set_column&lt;span style=&quot;color:#3f9101;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;&#39;A:A&#39;&lt;/span&gt;, &lt;span style=&quot;color:#1750eb;&quot;&gt;15&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;)  &lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;# Код ошибки&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;            &lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;worksheet&lt;/span&gt;.set_column&lt;span style=&quot;color:#3f9101;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;&#39;B:B&#39;&lt;/span&gt;, &lt;span style=&quot;color:#1750eb;&quot;&gt;40&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;)  &lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;# Наименование проверки&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;            &lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;worksheet&lt;/span&gt;.set_column&lt;span style=&quot;color:#3f9101;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;&#39;C:C&#39;&lt;/span&gt;, &lt;span style=&quot;color:#1750eb;&quot;&gt;40&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;)  &lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;# Инструмент исправления&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;            &lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;worksheet&lt;/span&gt;.set_column&lt;span style=&quot;color:#3f9101;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;&#39;D:D&#39;&lt;/span&gt;, &lt;span style=&quot;color:#1750eb;&quot;&gt;15&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;)  &lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;# Продукт&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;            # Добавляем заголовки с форматированием&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;            &lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;header_format &lt;/span&gt;= &lt;span style=&quot;color:#000000;&quot;&gt;workbook&lt;/span&gt;.add_format&lt;span style=&quot;color:#3f9101;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#0e4a8e;&quot;&gt;{&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#0e4a8e;&quot;&gt;                &lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;&#39;bold&#39;&lt;/span&gt;: &lt;span style=&quot;color:#0033b3;&quot;&gt;True&lt;/span&gt;,&lt;br&gt;                &lt;span style=&quot;color:#067d17;&quot;&gt;&#39;text_wrap&#39;&lt;/span&gt;: &lt;span style=&quot;color:#0033b3;&quot;&gt;True&lt;/span&gt;,&lt;br&gt;                &lt;span style=&quot;color:#067d17;&quot;&gt;&#39;valign&#39;&lt;/span&gt;: &lt;span style=&quot;color:#067d17;&quot;&gt;&#39;top&#39;&lt;/span&gt;,&lt;br&gt;                &lt;span style=&quot;color:#067d17;&quot;&gt;&#39;fg_color&#39;&lt;/span&gt;: &lt;span style=&quot;color:#067d17;&quot;&gt;&#39;#D7E4BC&#39;&lt;/span&gt;,&lt;br&gt;                &lt;span style=&quot;color:#067d17;&quot;&gt;&#39;border&#39;&lt;/span&gt;: &lt;span style=&quot;color:#1750eb;&quot;&gt;1&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#1750eb;&quot;&gt;            &lt;/span&gt;&lt;span style=&quot;color:#0e4a8e;&quot;&gt;}&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;)&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;            &lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;# Форматируем заголовки&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;            &lt;/span&gt;&lt;span style=&quot;color:#0033b3;&quot;&gt;for &lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;col_num&lt;/span&gt;, &lt;span style=&quot;color:#000000;&quot;&gt;value &lt;/span&gt;&lt;span style=&quot;color:#0033b3;&quot;&gt;in &lt;/span&gt;&lt;span style=&quot;color:#000080;&quot;&gt;enumerate&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#0e4a8e;&quot;&gt;[&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;&#39;Код ошибки&#39;&lt;/span&gt;, &lt;span style=&quot;color:#067d17;&quot;&gt;&#39;Наименование проверки&#39;&lt;/span&gt;, &lt;span style=&quot;color:#067d17;&quot;&gt;&#39;Инструмент исправления&#39;&lt;/span&gt;, &lt;span style=&quot;color:#067d17;&quot;&gt;&#39;Продукт&#39;&lt;/span&gt;&lt;span style=&quot;color:#0e4a8e;&quot;&gt;]&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;)&lt;/span&gt;:&lt;br&gt;                &lt;span style=&quot;color:#000000;&quot;&gt;worksheet&lt;/span&gt;.write&lt;span style=&quot;color:#3f9101;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#1750eb;&quot;&gt;0&lt;/span&gt;, &lt;span style=&quot;color:#000000;&quot;&gt;col_num&lt;/span&gt;, &lt;span style=&quot;color:#000000;&quot;&gt;value&lt;/span&gt;, &lt;span style=&quot;color:#000000;&quot;&gt;header_format&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;)&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;        &lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;# Получаем содержимое файла&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;        &lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;output&lt;/span&gt;.seek&lt;span style=&quot;color:#3f9101;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#1750eb;&quot;&gt;0&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;)&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;        &lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;excel_data &lt;/span&gt;= &lt;span style=&quot;color:#000000;&quot;&gt;output&lt;/span&gt;.getvalue&lt;span style=&quot;color:#3f9101;&quot;&gt;()&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;        &lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;# Кодируем в base64&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;        &lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;excel_base64 &lt;/span&gt;= base64.b64encode&lt;span style=&quot;color:#3f9101;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;excel_data&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;)&lt;/span&gt;.decode&lt;span style=&quot;color:#3f9101;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;&#39;utf-8&#39;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;)&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;        &lt;/span&gt;log&lt;span style=&quot;color:#3f9101;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;f&quot;ОТЧЕТ ДЛЯ &lt;/span&gt;&lt;span style=&quot;color:#0e4a8e;&quot;&gt;{&lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;epk_masked&lt;/span&gt;&lt;span style=&quot;color:#0e4a8e;&quot;&gt;}&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt; СОЗДАН. &lt;/span&gt;&lt;span style=&quot;color:#0e4a8e;&quot;&gt;{&lt;/span&gt;&lt;span style=&quot;color:#000080;&quot;&gt;str&lt;/span&gt;&lt;span style=&quot;color:#b4960a;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;html_report&lt;/span&gt;&lt;span style=&quot;color:#b4960a;&quot;&gt;)&lt;/span&gt;&lt;span style=&quot;color:#0e4a8e;&quot;&gt;}&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;&quot;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;)&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;        &lt;/span&gt;&lt;span style=&quot;color:#0033b3;&quot;&gt;return &lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;excel_base64&lt;/span&gt;, &lt;span style=&quot;color:#000000;&quot;&gt;html_report&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color:#0033b3;&quot;&gt;except &lt;/span&gt;&lt;span style=&quot;color:#000080;&quot;&gt;Exception &lt;/span&gt;&lt;span style=&quot;color:#0033b3;&quot;&gt;as &lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;e&lt;/span&gt;:&lt;br&gt;        log&lt;span style=&quot;color:#3f9101;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;f&quot;Ошибка при создании Excel файла: &lt;/span&gt;&lt;span style=&quot;color:#0e4a8e;&quot;&gt;{&lt;/span&gt;&lt;span style=&quot;color:#000080;&quot;&gt;str&lt;/span&gt;&lt;span style=&quot;color:#b4960a;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;e&lt;/span&gt;&lt;span style=&quot;color:#b4960a;&quot;&gt;)&lt;/span&gt;&lt;span style=&quot;color:#0e4a8e;&quot;&gt;}&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;&quot;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;)&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;        &lt;/span&gt;&lt;span style=&quot;color:#0033b3;&quot;&gt;return None&lt;/span&gt;, &lt;span style=&quot;color:#0033b3;&quot;&gt;None&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#0033b3;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#0033b3;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#0033b3;&quot;&gt;def &lt;/span&gt;&lt;span style=&quot;color:#00627a;&quot;&gt;save_error_codes&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;errors&lt;/span&gt;: &lt;span style=&quot;color:#000080;&quot;&gt;list&lt;/span&gt;, &lt;span style=&quot;color:#000000;&quot;&gt;epk_id&lt;/span&gt;: &lt;span style=&quot;color:#000080;&quot;&gt;str&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;) &lt;/span&gt;-&amp;gt; &lt;span style=&quot;color:#000080;&quot;&gt;bool&lt;/span&gt;:&lt;br&gt;    &lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;&quot;&quot;&quot;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    Сохраняет коды ошибок в JSON файл.&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    Args:&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;        errors: Список объектов с ошибками&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;        epk_id: Идентификатор организации&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    &quot;&quot;&quot;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;error_data &lt;/span&gt;= &lt;span style=&quot;color:#3f9101;&quot;&gt;{&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;        &lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;&#39;epk_id&#39;&lt;/span&gt;: &lt;span style=&quot;color:#000000;&quot;&gt;epk_id&lt;/span&gt;,&lt;br&gt;        &lt;span style=&quot;color:#067d17;&quot;&gt;&#39;errors&#39;&lt;/span&gt;: &lt;span style=&quot;color:#000000;&quot;&gt;errors&lt;/span&gt;,&lt;br&gt;        &lt;span style=&quot;color:#067d17;&quot;&gt;&#39;timestamp&#39;&lt;/span&gt;: datetime.datetime.now&lt;span style=&quot;color:#0e4a8e;&quot;&gt;()&lt;/span&gt;.isoformat&lt;span style=&quot;color:#0e4a8e;&quot;&gt;()&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#0e4a8e;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;}&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color:#0033b3;&quot;&gt;try&lt;/span&gt;:&lt;br&gt;        &lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;# Создаем директорию если её нет&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;        &lt;/span&gt;os.makedirs&lt;span style=&quot;color:#3f9101;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;&#39;app/basic_entities/utils/rejections/error_codes&#39;&lt;/span&gt;, &lt;span style=&quot;color:#660099;&quot;&gt;exist_ok&lt;/span&gt;=&lt;span style=&quot;color:#0033b3;&quot;&gt;True&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;)&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;        &lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;# Формируем имя файла с текущей датой&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;        &lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;filename &lt;/span&gt;= &lt;span style=&quot;color:#067d17;&quot;&gt;f&quot;app/basic_entities/utils/rejections/error_codes/errors_&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;{&lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;epk_id&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;}&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;_&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;{&lt;/span&gt;datetime.datetime.now&lt;span style=&quot;color:#0e4a8e;&quot;&gt;()&lt;/span&gt;.strftime&lt;span style=&quot;color:#0e4a8e;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;&#39;%Y%m%d_%H%M%S&#39;&lt;/span&gt;&lt;span style=&quot;color:#0e4a8e;&quot;&gt;)&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;}&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;.json&quot;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;        &lt;/span&gt;&lt;span style=&quot;color:#0033b3;&quot;&gt;with &lt;/span&gt;&lt;span style=&quot;color:#000080;&quot;&gt;open&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;filename&lt;/span&gt;, &lt;span style=&quot;color:#067d17;&quot;&gt;&#39;w&#39;&lt;/span&gt;, &lt;span style=&quot;color:#660099;&quot;&gt;encoding&lt;/span&gt;=&lt;span style=&quot;color:#067d17;&quot;&gt;&#39;utf-8&#39;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;) &lt;/span&gt;&lt;span style=&quot;color:#0033b3;&quot;&gt;as &lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;f&lt;/span&gt;:&lt;br&gt;            json.dump&lt;span style=&quot;color:#3f9101;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;error_data&lt;/span&gt;, &lt;span style=&quot;color:#000000;&quot;&gt;f&lt;/span&gt;, &lt;span style=&quot;color:#660099;&quot;&gt;ensure_ascii&lt;/span&gt;=&lt;span style=&quot;color:#0033b3;&quot;&gt;False&lt;/span&gt;, &lt;span style=&quot;color:#660099;&quot;&gt;indent&lt;/span&gt;=&lt;span style=&quot;color:#1750eb;&quot;&gt;2&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;)&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;        &lt;/span&gt;log&lt;span style=&quot;color:#3f9101;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;f&quot;Ошибки сохранены в файл: &lt;/span&gt;&lt;span style=&quot;color:#0e4a8e;&quot;&gt;{&lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;filename&lt;/span&gt;&lt;span style=&quot;color:#0e4a8e;&quot;&gt;}&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;&quot;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;)&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;        &lt;/span&gt;&lt;span style=&quot;color:#0033b3;&quot;&gt;return True&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#0033b3;&quot;&gt;    except &lt;/span&gt;&lt;span style=&quot;color:#000080;&quot;&gt;Exception &lt;/span&gt;&lt;span style=&quot;color:#0033b3;&quot;&gt;as &lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;e&lt;/span&gt;:&lt;br&gt;        log&lt;span style=&quot;color:#3f9101;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;f&quot;Ошибка при сохранении файла с ошибками: &lt;/span&gt;&lt;span style=&quot;color:#0e4a8e;&quot;&gt;{&lt;/span&gt;&lt;span style=&quot;color:#000080;&quot;&gt;str&lt;/span&gt;&lt;span style=&quot;color:#b4960a;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;e&lt;/span&gt;&lt;span style=&quot;color:#b4960a;&quot;&gt;)&lt;/span&gt;&lt;span style=&quot;color:#0e4a8e;&quot;&gt;}&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;&quot;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;)&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;        &lt;/span&gt;&lt;span style=&quot;color:#0033b3;&quot;&gt;return False&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#0033b3;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#0033b3;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#0033b3;&quot;&gt;def &lt;/span&gt;&lt;span style=&quot;color:#00627a;&quot;&gt;return_cluster_id&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;text&lt;/span&gt;: &lt;span style=&quot;color:#000080;&quot;&gt;str&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;) &lt;/span&gt;-&amp;gt; &lt;span style=&quot;color:#000080;&quot;&gt;list&lt;/span&gt;:&lt;br&gt;    &lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;&quot;&quot;&quot;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    возвращаем список кластеров&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    &quot;&quot;&quot;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;clusters &lt;/span&gt;= &lt;span style=&quot;color:#3f9101;&quot;&gt;{&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;        &lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;&quot;Корпоративное кредитование&quot;&lt;/span&gt;: &lt;span style=&quot;color:#0e4a8e;&quot;&gt;[&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;&quot;CORP_CRED&quot;&lt;/span&gt;, &lt;span style=&quot;color:#067d17;&quot;&gt;&quot;CORP_CRED_VKL_NKL&quot;&lt;/span&gt;&lt;span style=&quot;color:#0e4a8e;&quot;&gt;]&lt;/span&gt;,&lt;br&gt;        &lt;span style=&quot;color:#067d17;&quot;&gt;&quot;Овердрафт&quot;&lt;/span&gt;: &lt;span style=&quot;color:#0e4a8e;&quot;&gt;[&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;&quot;OVERDRAFT&quot;&lt;/span&gt;&lt;span style=&quot;color:#0e4a8e;&quot;&gt;]&lt;/span&gt;,&lt;br&gt;        &lt;span style=&quot;color:#067d17;&quot;&gt;&quot;Гарантии&quot;&lt;/span&gt;: &lt;span style=&quot;color:#0e4a8e;&quot;&gt;[&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;&quot;CUSTOMS&quot;&lt;/span&gt;, &lt;span style=&quot;color:#067d17;&quot;&gt;&quot;NDS&quot;&lt;/span&gt;, &lt;span style=&quot;color:#067d17;&quot;&gt;&quot;EXCISE&quot;&lt;/span&gt;, &lt;span style=&quot;color:#067d17;&quot;&gt;&quot;TENDER&quot;&lt;/span&gt;, &lt;span style=&quot;color:#067d17;&quot;&gt;&quot;CONTRACTUAL&quot;&lt;/span&gt;, &lt;span style=&quot;color:#067d17;&quot;&gt;&quot;CONTRACTUAL_FZ&quot;&lt;/span&gt;, &lt;span style=&quot;color:#067d17;&quot;&gt;&quot;FINANCIAL&quot;&lt;/span&gt;&lt;span style=&quot;color:#0e4a8e;&quot;&gt;]&lt;/span&gt;,&lt;br&gt;        &lt;span style=&quot;color:#067d17;&quot;&gt;&quot;Продукты ДЗО&quot;&lt;/span&gt;: &lt;span style=&quot;color:#0e4a8e;&quot;&gt;[&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;&quot;LEASING&quot;&lt;/span&gt;, &lt;span style=&quot;color:#067d17;&quot;&gt;&quot;FACTORING&quot;&lt;/span&gt;&lt;span style=&quot;color:#0e4a8e;&quot;&gt;]&lt;/span&gt;,&lt;br&gt;        &lt;span style=&quot;color:#067d17;&quot;&gt;&quot;НПА&quot;&lt;/span&gt;: &lt;span style=&quot;color:#0e4a8e;&quot;&gt;[&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;&quot;UNCOVERED_LETTER_OF_CREDIT&quot;&lt;/span&gt;&lt;span style=&quot;color:#0e4a8e;&quot;&gt;]&lt;/span&gt;,&lt;br&gt;        &lt;span style=&quot;color:#067d17;&quot;&gt;&quot;Все продукты&quot;&lt;/span&gt;: &lt;span style=&quot;color:#0e4a8e;&quot;&gt;[&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;&quot;ALL_PRODUCTS&quot;&lt;/span&gt;&lt;span style=&quot;color:#0e4a8e;&quot;&gt;]&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#0e4a8e;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;}&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color:#0033b3;&quot;&gt;return &lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;clusters&lt;/span&gt;.get&lt;span style=&quot;color:#3f9101;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;text&lt;/span&gt;, &lt;span style=&quot;color:#0e4a8e;&quot;&gt;[]&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;)&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#0033b3;&quot;&gt;def &lt;/span&gt;&lt;span style=&quot;color:#00627a;&quot;&gt;get_profile_user&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;params&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;) &lt;/span&gt;-&amp;gt; &lt;span style=&quot;color:#000080;&quot;&gt;dict&lt;/span&gt;:&lt;br&gt;    &lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;&quot;&quot;&quot;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    Получает профиль пользователя из profile_employee&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    В случае отсутствия профиля в profile_employee, возвращает профиль из profile_example.json&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    &quot;&quot;&quot;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color:#0033b3;&quot;&gt;if &lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;params&lt;/span&gt;:&lt;br&gt;        &lt;span style=&quot;color:#000000;&quot;&gt;profile &lt;/span&gt;= &lt;span style=&quot;color:#000000;&quot;&gt;params&lt;/span&gt;.get&lt;span style=&quot;color:#3f9101;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;&quot;payload&quot;&lt;/span&gt;, &lt;span style=&quot;color:#0e4a8e;&quot;&gt;{}&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;)&lt;/span&gt;.get&lt;span style=&quot;color:#3f9101;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;&quot;employee_profile&quot;&lt;/span&gt;, &lt;span style=&quot;color:#0e4a8e;&quot;&gt;{}&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;)&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;        &lt;/span&gt;log&lt;span style=&quot;color:#3f9101;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;f&quot;Данные профиля пользователя взяты из profile_employee - &lt;/span&gt;&lt;span style=&quot;color:#0e4a8e;&quot;&gt;{&lt;/span&gt;&lt;span style=&quot;color:#000080;&quot;&gt;str&lt;/span&gt;&lt;span style=&quot;color:#b4960a;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;profile&lt;/span&gt;&lt;span style=&quot;color:#b4960a;&quot;&gt;)&lt;/span&gt;&lt;span style=&quot;color:#0e4a8e;&quot;&gt;}&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;&quot;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;)&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;        &lt;/span&gt;&lt;span style=&quot;color:#0033b3;&quot;&gt;if &lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;profile&lt;/span&gt;.get&lt;span style=&quot;color:#3f9101;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;&quot;profileInfo&quot;&lt;/span&gt;, &lt;span style=&quot;color:#0e4a8e;&quot;&gt;{}&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;)&lt;/span&gt;.get&lt;span style=&quot;color:#3f9101;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;&quot;personalNumber&quot;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;)&lt;/span&gt;:&lt;br&gt;            &lt;span style=&quot;color:#0033b3;&quot;&gt;return &lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;profile&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color:#0033b3;&quot;&gt;else&lt;/span&gt;:&lt;br&gt;        &lt;span style=&quot;color:#0033b3;&quot;&gt;return &lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;{}&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;# with open(&quot;app/basic_entities/utils/rejections/profile_example.json&quot;, &quot;r&quot;) as file:&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    #     profile = json.load(file)&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    #     log(&quot;Тестовые Данные профиля пользователя взяты из profile_example.json&quot;)&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    #     return profile&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#0033b3;&quot;&gt;def &lt;/span&gt;&lt;span style=&quot;color:#00627a;&quot;&gt;prepare_email_to_user&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;params&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;) &lt;/span&gt;-&amp;gt; &lt;span style=&quot;color:#000080;&quot;&gt;str&lt;/span&gt;:&lt;br&gt;    &lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;&quot;&quot;&quot;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    Подготавливает email для отправки пользователю&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    &quot;&quot;&quot;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;surface &lt;/span&gt;= &lt;span style=&quot;color:#000000;&quot;&gt;params&lt;/span&gt;.get&lt;span style=&quot;color:#3f9101;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;&#39;payload&#39;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;)&lt;/span&gt;.get&lt;span style=&quot;color:#3f9101;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;&#39;device&#39;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;)&lt;/span&gt;.get&lt;span style=&quot;color:#3f9101;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;&#39;surface&#39;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;)&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color:#0033b3;&quot;&gt;if &lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;surface &lt;/span&gt;== &lt;span style=&quot;color:#067d17;&quot;&gt;&#39;SBERDRUG_SIGMA&#39;&lt;/span&gt;:&lt;br&gt;        &lt;span style=&quot;color:#000000;&quot;&gt;email &lt;/span&gt;= &lt;span style=&quot;color:#000000;&quot;&gt;params&lt;/span&gt;.get&lt;span style=&quot;color:#3f9101;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;&#39;payload&#39;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;)&lt;/span&gt;.get&lt;span style=&quot;color:#3f9101;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;&#39;employee_profile&#39;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;)&lt;/span&gt;.get&lt;span style=&quot;color:#3f9101;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;&#39;profileInfo&#39;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;)&lt;/span&gt;.get&lt;span style=&quot;color:#3f9101;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;&#39;eMailSigma&#39;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;)&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color:#0033b3;&quot;&gt;elif &lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;surface &lt;/span&gt;== &lt;span style=&quot;color:#067d17;&quot;&gt;&#39;SBERDRUG_ALPHA&#39;&lt;/span&gt;:&lt;br&gt;        &lt;span style=&quot;color:#000000;&quot;&gt;email &lt;/span&gt;= &lt;span style=&quot;color:#000000;&quot;&gt;params&lt;/span&gt;.get&lt;span style=&quot;color:#3f9101;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;&#39;payload&#39;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;)&lt;/span&gt;.get&lt;span style=&quot;color:#3f9101;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;&#39;employee_profile&#39;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;)&lt;/span&gt;.get&lt;span style=&quot;color:#3f9101;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;&#39;profileInfo&#39;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;)&lt;/span&gt;.get&lt;span style=&quot;color:#3f9101;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;&#39;eMailAlpha&#39;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;)&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color:#0033b3;&quot;&gt;else&lt;/span&gt;:&lt;br&gt;        &lt;span style=&quot;color:#000000;&quot;&gt;email &lt;/span&gt;= &lt;span style=&quot;color:#000000;&quot;&gt;params&lt;/span&gt;.get&lt;span style=&quot;color:#3f9101;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;&#39;payload&#39;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;)&lt;/span&gt;.get&lt;span style=&quot;color:#3f9101;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;&#39;employee_profile&#39;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;)&lt;/span&gt;.get&lt;span style=&quot;color:#3f9101;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;&#39;profileInfo&#39;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;)&lt;/span&gt;.get&lt;span style=&quot;color:#3f9101;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;&#39;mainEmail&#39;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;)&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color:#0033b3;&quot;&gt;if not &lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;email&lt;/span&gt;:&lt;br&gt;        &lt;span style=&quot;color:#000000;&quot;&gt;email &lt;/span&gt;= &lt;span style=&quot;color:#067d17;&quot;&gt;&quot;vas_dkpp@sigma-exchtest.sbrf.ru&quot;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color:#0033b3;&quot;&gt;return &lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;email&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#0033b3;&quot;&gt;def &lt;/span&gt;&lt;span style=&quot;color:#00627a;&quot;&gt;process_and_save_errors_to_excel&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;api_errors&lt;/span&gt;: &lt;span style=&quot;color:#000080;&quot;&gt;list&lt;/span&gt;, &lt;span style=&quot;color:#000000;&quot;&gt;epk_id&lt;/span&gt;: &lt;span style=&quot;color:#000080;&quot;&gt;str&lt;/span&gt;, &lt;span style=&quot;color:#000000;&quot;&gt;user_email&lt;/span&gt;: &lt;span style=&quot;color:#000080;&quot;&gt;str &lt;/span&gt;= &lt;span style=&quot;color:#0033b3;&quot;&gt;None&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;) &lt;/span&gt;-&amp;gt; &lt;span style=&quot;color:#000080;&quot;&gt;str&lt;/span&gt;:&lt;br&gt;    &lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;&quot;&quot;&quot;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    Обрабатывает список ошибок от API, добавляет к ним информацию из справочника&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    и сохраняет результат в Excel-файл или отправляет по почте.&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    Args:&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;        api_errors: Список ошибок, полученных из API&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;        epk_id: Идентификатор организации&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;        user_email: Email пользователя для отправки отчета&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    Returns:&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;        str: Путь к созданному Excel файлу, &quot;email_sent&quot; если отчет отправлен по почте,&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;             или пустая строка в случае ошибки&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    &quot;&quot;&quot;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;epk_masked &lt;/span&gt;= &lt;span style=&quot;color:#000000;&quot;&gt;epk_id&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;[&lt;/span&gt;:&lt;span style=&quot;color:#1750eb;&quot;&gt;4&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;] &lt;/span&gt;+ &lt;span style=&quot;color:#067d17;&quot;&gt;&quot;****&quot; &lt;/span&gt;+ &lt;span style=&quot;color:#000000;&quot;&gt;epk_id&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;[&lt;/span&gt;-&lt;span style=&quot;color:#1750eb;&quot;&gt;4&lt;/span&gt;:&lt;span style=&quot;color:#3f9101;&quot;&gt;]&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color:#0033b3;&quot;&gt;try&lt;/span&gt;:&lt;br&gt;        log&lt;span style=&quot;color:#3f9101;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;f&quot;Начинаем обработку &lt;/span&gt;&lt;span style=&quot;color:#0e4a8e;&quot;&gt;{&lt;/span&gt;&lt;span style=&quot;color:#000080;&quot;&gt;len&lt;/span&gt;&lt;span style=&quot;color:#b4960a;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;api_errors&lt;/span&gt;&lt;span style=&quot;color:#b4960a;&quot;&gt;)&lt;/span&gt;&lt;span style=&quot;color:#0e4a8e;&quot;&gt;}&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt; ошибок для ЕПК &lt;/span&gt;&lt;span style=&quot;color:#0e4a8e;&quot;&gt;{&lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;epk_id&lt;/span&gt;&lt;span style=&quot;color:#0e4a8e;&quot;&gt;}&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;&quot;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;)&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;        &lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;# Получаем словарь с кодами ошибок из справочника&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;        &lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;error_codes_dict &lt;/span&gt;= get_error_codes_from_excel&lt;span style=&quot;color:#3f9101;&quot;&gt;()&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;        &lt;/span&gt;log&lt;span style=&quot;color:#3f9101;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;f&quot;Загружено &lt;/span&gt;&lt;span style=&quot;color:#0e4a8e;&quot;&gt;{&lt;/span&gt;&lt;span style=&quot;color:#000080;&quot;&gt;len&lt;/span&gt;&lt;span style=&quot;color:#b4960a;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;error_codes_dict&lt;/span&gt;&lt;span style=&quot;color:#b4960a;&quot;&gt;)&lt;/span&gt;&lt;span style=&quot;color:#0e4a8e;&quot;&gt;}&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt; кодов ошибок из справочника&quot;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;)&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;        &lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;# Создаем Excel файл с обработанными ошибками&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;        &lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;excel_base64&lt;/span&gt;, &lt;span style=&quot;color:#000000;&quot;&gt;html_report &lt;/span&gt;= create_excel_from_dicts&lt;span style=&quot;color:#3f9101;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;error_codes_dict&lt;/span&gt;, &lt;span style=&quot;color:#000000;&quot;&gt;api_errors&lt;/span&gt;, &lt;span style=&quot;color:#000000;&quot;&gt;epk_id&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;)&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;        &lt;/span&gt;&lt;span style=&quot;color:#0033b3;&quot;&gt;if not &lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;excel_base64&lt;/span&gt;:&lt;br&gt;            log&lt;span style=&quot;color:#3f9101;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;f&quot;Не удалось создать Excel файл для ЕПК &lt;/span&gt;&lt;span style=&quot;color:#0e4a8e;&quot;&gt;{&lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;epk_id&lt;/span&gt;&lt;span style=&quot;color:#0e4a8e;&quot;&gt;}&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;&quot;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;)&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;            &lt;/span&gt;&lt;span style=&quot;color:#0033b3;&quot;&gt;return &lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;&quot;&quot;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;        &lt;/span&gt;log&lt;span style=&quot;color:#3f9101;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;f&quot;Excel файл успешно создан в памяти&quot;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;)&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;        &lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;# Формируем имя файла с текущей датой&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;        &lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;filename &lt;/span&gt;= &lt;span style=&quot;color:#067d17;&quot;&gt;f&quot;errors_report_&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;{&lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;epk_masked&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;}&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;_&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;{&lt;/span&gt;datetime.datetime.now&lt;span style=&quot;color:#0e4a8e;&quot;&gt;()&lt;/span&gt;.strftime&lt;span style=&quot;color:#0e4a8e;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;&#39;%Y%m%d_%H%M%S&#39;&lt;/span&gt;&lt;span style=&quot;color:#0e4a8e;&quot;&gt;)&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;}&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;.xlsx&quot;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;        &lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;# Определяем, находимся ли мы на dev стенде&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;        &lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;env &lt;/span&gt;= os.getenv&lt;span style=&quot;color:#3f9101;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;&#39;PLATFORM&#39;&lt;/span&gt;, &lt;span style=&quot;color:#067d17;&quot;&gt;&#39;dev&#39;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;)&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;        &lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;is_dev_env &lt;/span&gt;= &lt;span style=&quot;color:#000000;&quot;&gt;env&lt;/span&gt;.lower&lt;span style=&quot;color:#3f9101;&quot;&gt;() &lt;/span&gt;== &lt;span style=&quot;color:#067d17;&quot;&gt;&#39;dev&#39;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;        &lt;/span&gt;log&lt;span style=&quot;color:#3f9101;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;f&quot;Текущее окружение: &lt;/span&gt;&lt;span style=&quot;color:#0e4a8e;&quot;&gt;{&lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;env&lt;/span&gt;&lt;span style=&quot;color:#0e4a8e;&quot;&gt;}&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;, is_dev_env=&lt;/span&gt;&lt;span style=&quot;color:#0e4a8e;&quot;&gt;{&lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;is_dev_env&lt;/span&gt;&lt;span style=&quot;color:#0e4a8e;&quot;&gt;}&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;&quot;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;)&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;        &lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;# Пробуем сохранить файл в любом случае, но обрабатываем ошибки&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;        &lt;/span&gt;&lt;span style=&quot;color:#808080;&quot;&gt;file_saved &lt;/span&gt;= &lt;span style=&quot;color:#0033b3;&quot;&gt;False&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#0033b3;&quot;&gt;        &lt;/span&gt;&lt;span style=&quot;color:#808080;&quot;&gt;file_path &lt;/span&gt;= &lt;span style=&quot;color:#067d17;&quot;&gt;&quot;&quot;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;        &lt;/span&gt;&lt;span style=&quot;color:#0033b3;&quot;&gt;try&lt;/span&gt;:&lt;br&gt;            &lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;# Создаем директорию для сохранения Excel файлов, если её нет&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;            &lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;excel_dir &lt;/span&gt;= &lt;span style=&quot;color:#067d17;&quot;&gt;&#39;app/basic_entities/utils/rejections/excel_reports&#39;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;            &lt;/span&gt;os.makedirs&lt;span style=&quot;color:#3f9101;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;excel_dir&lt;/span&gt;, &lt;span style=&quot;color:#660099;&quot;&gt;exist_ok&lt;/span&gt;=&lt;span style=&quot;color:#0033b3;&quot;&gt;True&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;)&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;            &lt;/span&gt;log&lt;span style=&quot;color:#3f9101;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;f&quot;Директория для сохранения файлов создана: &lt;/span&gt;&lt;span style=&quot;color:#0e4a8e;&quot;&gt;{&lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;excel_dir&lt;/span&gt;&lt;span style=&quot;color:#0e4a8e;&quot;&gt;}&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;&quot;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;)&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;            &lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;# Полный путь к файлу&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;            &lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;file_path &lt;/span&gt;= &lt;span style=&quot;color:#067d17;&quot;&gt;f&quot;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;{&lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;excel_dir&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;}&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;/&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;{&lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;filename&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;}&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;&quot;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;            &lt;/span&gt;log&lt;span style=&quot;color:#3f9101;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;f&quot;Пытаемся сохранить файл по пути: &lt;/span&gt;&lt;span style=&quot;color:#0e4a8e;&quot;&gt;{&lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;file_path&lt;/span&gt;&lt;span style=&quot;color:#0e4a8e;&quot;&gt;}&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;&quot;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;)&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;            &lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;# Декодируем base64 и сохраняем в файл&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;            &lt;/span&gt;&lt;span style=&quot;color:#0033b3;&quot;&gt;with &lt;/span&gt;&lt;span style=&quot;color:#000080;&quot;&gt;open&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;file_path&lt;/span&gt;, &lt;span style=&quot;color:#067d17;&quot;&gt;&#39;wb&#39;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;) &lt;/span&gt;&lt;span style=&quot;color:#0033b3;&quot;&gt;as &lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;f&lt;/span&gt;:&lt;br&gt;                &lt;span style=&quot;color:#000000;&quot;&gt;f&lt;/span&gt;.write&lt;span style=&quot;color:#3f9101;&quot;&gt;(&lt;/span&gt;base64.b64decode&lt;span style=&quot;color:#0e4a8e;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;excel_base64&lt;/span&gt;&lt;span style=&quot;color:#0e4a8e;&quot;&gt;)&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;)&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;            &lt;/span&gt;log&lt;span style=&quot;color:#3f9101;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;f&quot;Excel отчет с ошибками сохранен в файл: &lt;/span&gt;&lt;span style=&quot;color:#0e4a8e;&quot;&gt;{&lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;file_path&lt;/span&gt;&lt;span style=&quot;color:#0e4a8e;&quot;&gt;}&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;&quot;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;)&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;            &lt;/span&gt;&lt;span style=&quot;color:#808080;&quot;&gt;file_saved &lt;/span&gt;= &lt;span style=&quot;color:#0033b3;&quot;&gt;True&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#0033b3;&quot;&gt;        except &lt;/span&gt;&lt;span style=&quot;color:#000080;&quot;&gt;Exception &lt;/span&gt;&lt;span style=&quot;color:#0033b3;&quot;&gt;as &lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;e&lt;/span&gt;:&lt;br&gt;            log&lt;span style=&quot;color:#3f9101;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;f&quot;Ошибка при сохранении файла: &lt;/span&gt;&lt;span style=&quot;color:#0e4a8e;&quot;&gt;{&lt;/span&gt;&lt;span style=&quot;color:#000080;&quot;&gt;str&lt;/span&gt;&lt;span style=&quot;color:#b4960a;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;e&lt;/span&gt;&lt;span style=&quot;color:#b4960a;&quot;&gt;)&lt;/span&gt;&lt;span style=&quot;color:#0e4a8e;&quot;&gt;}&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;&quot;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;)&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;            &lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;# Продолжаем выполнение, чтобы попробовать отправить по почте&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;        # Отправляем отчет по почте, если указан email&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;        &lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;email_sent &lt;/span&gt;= &lt;span style=&quot;color:#0033b3;&quot;&gt;False&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#0033b3;&quot;&gt;        if &lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;user_email&lt;/span&gt;:&lt;br&gt;            log&lt;span style=&quot;color:#3f9101;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;f&quot;Пытаемся отправить отчет по почте на адрес: &lt;/span&gt;&lt;span style=&quot;color:#0e4a8e;&quot;&gt;{&lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;user_email&lt;/span&gt;&lt;span style=&quot;color:#0e4a8e;&quot;&gt;}&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;&quot;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;)&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;            &lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;# Сначала пробуем отправить с вложением&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;            &lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;email_sent &lt;/span&gt;= send_email_with_attach&lt;span style=&quot;color:#3f9101;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;excel_base64&lt;/span&gt;, &lt;span style=&quot;color:#000000;&quot;&gt;filename&lt;/span&gt;, &lt;span style=&quot;color:#000000;&quot;&gt;user_email&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;)&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;            &lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;# Если отправка с вложением не удалась, пробуем отправить HTML отчет&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;            &lt;/span&gt;&lt;span style=&quot;color:#0033b3;&quot;&gt;if &lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;html_report&lt;/span&gt;:&lt;br&gt;                log&lt;span style=&quot;color:#3f9101;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;f&quot; пробуем отправить HTML отчет&quot;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;)&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;                &lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;email_sent &lt;/span&gt;= send_email_with_text&lt;span style=&quot;color:#3f9101;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;html_report&lt;/span&gt;, &lt;span style=&quot;color:#000000;&quot;&gt;user_email&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;)&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;            &lt;/span&gt;&lt;span style=&quot;color:#0033b3;&quot;&gt;if &lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;email_sent&lt;/span&gt;:&lt;br&gt;                log&lt;span style=&quot;color:#3f9101;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;f&quot;Отчет отправлен по почте на адрес: &lt;/span&gt;&lt;span style=&quot;color:#0e4a8e;&quot;&gt;{&lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;user_email&lt;/span&gt;&lt;span style=&quot;color:#0e4a8e;&quot;&gt;}&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;&quot;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;)&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;            &lt;/span&gt;&lt;span style=&quot;color:#0033b3;&quot;&gt;else&lt;/span&gt;:&lt;br&gt;                log&lt;span style=&quot;color:#3f9101;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;f&quot;Не удалось отправить отчет по почте на адрес: &lt;/span&gt;&lt;span style=&quot;color:#0e4a8e;&quot;&gt;{&lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;user_email&lt;/span&gt;&lt;span style=&quot;color:#0e4a8e;&quot;&gt;}&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;&quot;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;)&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;        &lt;/span&gt;&lt;span style=&quot;color:#0033b3;&quot;&gt;else&lt;/span&gt;:&lt;br&gt;            log&lt;span style=&quot;color:#3f9101;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;&quot;Email пользователя не указан, отправка по почте пропущена&quot;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;)&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;        &lt;/span&gt;&lt;span style=&quot;color:#0033b3;&quot;&gt;if &lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;email_sent&lt;/span&gt;:&lt;br&gt;            &lt;span style=&quot;color:#0033b3;&quot;&gt;return &lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;&quot;email_sent&quot;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;        &lt;/span&gt;&lt;span style=&quot;color:#0033b3;&quot;&gt;else&lt;/span&gt;:&lt;br&gt;            log&lt;span style=&quot;color:#3f9101;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;&quot;Не удалось ни сохранить файл, ни отправить его по почте&quot;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;)&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;            &lt;/span&gt;&lt;span style=&quot;color:#0033b3;&quot;&gt;return &lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;&quot;ошибка при отправке отчета&quot;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color:#0033b3;&quot;&gt;except &lt;/span&gt;&lt;span style=&quot;color:#000080;&quot;&gt;Exception &lt;/span&gt;&lt;span style=&quot;color:#0033b3;&quot;&gt;as &lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;e&lt;/span&gt;:&lt;br&gt;        log&lt;span style=&quot;color:#3f9101;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;f&quot;Ошибка при обработке и сохранении ошибок в Excel: &lt;/span&gt;&lt;span style=&quot;color:#0e4a8e;&quot;&gt;{&lt;/span&gt;&lt;span style=&quot;color:#000080;&quot;&gt;str&lt;/span&gt;&lt;span style=&quot;color:#b4960a;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;e&lt;/span&gt;&lt;span style=&quot;color:#b4960a;&quot;&gt;)&lt;/span&gt;&lt;span style=&quot;color:#0e4a8e;&quot;&gt;}&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;&quot;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;)&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;        &lt;/span&gt;&lt;span style=&quot;color:#0033b3;&quot;&gt;return &lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;&quot;ошибка при отправке отчета&quot;&lt;/span&gt;&lt;/pre&gt;&lt;/div&gt;" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="1" vertex="1">
          <mxGeometry x="380" y="370" width="60" height="30" as="geometry" />
        </mxCell>
        <UserObject label="&lt;div style=&quot;background-color:#ffffff;color:#080808&quot;&gt;&lt;pre style=&quot;font-family:&#39;JetBrains Mono&#39;,monospace;font-size:9,8pt;&quot;&gt;&lt;span style=&quot;color:#0033b3;&quot;&gt;from &lt;/span&gt;app.basic_entities.utils.rejections.api_5_ift &lt;span style=&quot;color:#0033b3;&quot;&gt;import &lt;/span&gt;send_request &lt;span style=&quot;color:#0033b3;&quot;&gt;as &lt;/span&gt;send_request5&lt;br&gt;&lt;span style=&quot;color:#0033b3;&quot;&gt;from &lt;/span&gt;core.logging.logger_utils &lt;span style=&quot;color:#0033b3;&quot;&gt;import &lt;/span&gt;log&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;span style=&quot;color:#0033b3;&quot;&gt;def &lt;/span&gt;&lt;span style=&quot;color:#00627a;&quot;&gt;send_request&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;ucpId&lt;/span&gt;, &lt;span style=&quot;color:#000000;&quot;&gt;clustId&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;)&lt;/span&gt;:&lt;br&gt;    &lt;span style=&quot;color:#000000;&quot;&gt;answer &lt;/span&gt;= send_request5&lt;span style=&quot;color:#3f9101;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#660099;&quot;&gt;ucpId &lt;/span&gt;= &lt;span style=&quot;color:#000000;&quot;&gt;ucpId&lt;/span&gt;, &lt;span style=&quot;color:#660099;&quot;&gt;clustId &lt;/span&gt;= &lt;span style=&quot;color:#000000;&quot;&gt;clustId&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;)&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;    &lt;/span&gt;log&lt;span style=&quot;color:#3f9101;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;&#39;Получен ответ на запрос к API5: &#39; &lt;/span&gt;+ &lt;span style=&quot;color:#000080;&quot;&gt;str&lt;/span&gt;&lt;span style=&quot;color:#0e4a8e;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;answer&lt;/span&gt;&lt;span style=&quot;color:#0e4a8e;&quot;&gt;)&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;)&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color:#0033b3;&quot;&gt;return &lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;answer&lt;br&gt;&lt;/span&gt;&lt;/pre&gt;&lt;/div&gt;" link="&lt;div style=&quot;background-color:#ffffff;color:#080808&quot;&gt;&lt;pre style=&quot;font-family:&#39;JetBrains Mono&#39;,monospace;font-size:9,8pt;&quot;&gt;&lt;span style=&quot;color:#0033b3;&quot;&gt;from &lt;/span&gt;app.basic_entities.utils.rejections.api_5_ift &lt;span style=&quot;color:#0033b3;&quot;&gt;import &lt;/span&gt;send_request &lt;span style=&quot;color:#0033b3;&quot;&gt;as &lt;/span&gt;send_request5&lt;br&gt;&lt;span style=&quot;color:#0033b3;&quot;&gt;from &lt;/span&gt;core.logging.logger_utils &lt;span style=&quot;color:#0033b3;&quot;&gt;import &lt;/span&gt;log&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;span style=&quot;color:#0033b3;&quot;&gt;def &lt;/span&gt;&lt;span style=&quot;color:#00627a;&quot;&gt;send_request&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;ucpId&lt;/span&gt;, &lt;span style=&quot;color:#000000;&quot;&gt;clustId&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;)&lt;/span&gt;:&lt;br&gt;    &lt;span style=&quot;color:#000000;&quot;&gt;answer &lt;/span&gt;= send_request5&lt;span style=&quot;color:#3f9101;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#660099;&quot;&gt;ucpId &lt;/span&gt;= &lt;span style=&quot;color:#000000;&quot;&gt;ucpId&lt;/span&gt;, &lt;span style=&quot;color:#660099;&quot;&gt;clustId &lt;/span&gt;= &lt;span style=&quot;color:#000000;&quot;&gt;clustId&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;)&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;    &lt;/span&gt;log&lt;span style=&quot;color:#3f9101;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;&#39;Получен ответ на запрос к API5: &#39; &lt;/span&gt;+ &lt;span style=&quot;color:#000080;&quot;&gt;str&lt;/span&gt;&lt;span style=&quot;color:#0e4a8e;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;answer&lt;/span&gt;&lt;span style=&quot;color:#0e4a8e;&quot;&gt;)&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;)&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color:#0033b3;&quot;&gt;return &lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;answer&lt;br&gt;&lt;/span&gt;&lt;/pre&gt;&lt;/div&gt;" id="Vc2Rvw61kaMBHnZ_WlHz-1">
          <mxCell style="text;whiteSpace=wrap;html=1;" vertex="1" parent="1">
            <mxGeometry x="390" y="-5800" width="560" height="160" as="geometry" />
          </mxCell>
        </UserObject>
        <UserObject label="&lt;div style=&quot;background-color:#ffffff;color:#080808&quot;&gt;&lt;pre style=&quot;font-family:&#39;JetBrains Mono&#39;,monospace;font-size:9,8pt;&quot;&gt;&lt;span style=&quot;color:#0033b3;&quot;&gt;from &lt;/span&gt;app.basic_entities.utils.rejections.api_6_ift &lt;span style=&quot;color:#0033b3;&quot;&gt;import &lt;/span&gt;send_get_request &lt;span style=&quot;color:#0033b3;&quot;&gt;as &lt;/span&gt;send_request6&lt;br&gt;&lt;span style=&quot;color:#0033b3;&quot;&gt;from &lt;/span&gt;core.logging.logger_utils &lt;span style=&quot;color:#0033b3;&quot;&gt;import &lt;/span&gt;log&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;span style=&quot;color:#0033b3;&quot;&gt;def &lt;/span&gt;&lt;span style=&quot;color:#00627a;&quot;&gt;send_get_request&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;bpId&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;)&lt;/span&gt;:&lt;br&gt;    log&lt;span style=&quot;color:#3f9101;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;f&quot;Sending request to API6 for bpId: &lt;/span&gt;&lt;span style=&quot;color:#0e4a8e;&quot;&gt;{&lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;bpId&lt;/span&gt;&lt;span style=&quot;color:#0e4a8e;&quot;&gt;}&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;&quot;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;)&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;answer &lt;/span&gt;= send_request6&lt;span style=&quot;color:#3f9101;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;bpId&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;)&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;    &lt;/span&gt;log&lt;span style=&quot;color:#3f9101;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;f&quot;Получен ответ на запрос к API6: &lt;/span&gt;&lt;span style=&quot;color:#0e4a8e;&quot;&gt;{&lt;/span&gt;&lt;span style=&quot;color:#000080;&quot;&gt;str&lt;/span&gt;&lt;span style=&quot;color:#b4960a;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;answer&lt;/span&gt;&lt;span style=&quot;color:#b4960a;&quot;&gt;)&lt;/span&gt;&lt;span style=&quot;color:#0e4a8e;&quot;&gt;}&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;&quot;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;)&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color:#0033b3;&quot;&gt;return &lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;answer&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;/pre&gt;&lt;/div&gt;" link="&lt;div style=&quot;background-color:#ffffff;color:#080808&quot;&gt;&lt;pre style=&quot;font-family:&#39;JetBrains Mono&#39;,monospace;font-size:9,8pt;&quot;&gt;&lt;span style=&quot;color:#0033b3;&quot;&gt;from &lt;/span&gt;app.basic_entities.utils.rejections.api_6_ift &lt;span style=&quot;color:#0033b3;&quot;&gt;import &lt;/span&gt;send_get_request &lt;span style=&quot;color:#0033b3;&quot;&gt;as &lt;/span&gt;send_request6&lt;br&gt;&lt;span style=&quot;color:#0033b3;&quot;&gt;from &lt;/span&gt;core.logging.logger_utils &lt;span style=&quot;color:#0033b3;&quot;&gt;import &lt;/span&gt;log&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;span style=&quot;color:#0033b3;&quot;&gt;def &lt;/span&gt;&lt;span style=&quot;color:#00627a;&quot;&gt;send_get_request&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;bpId&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;)&lt;/span&gt;:&lt;br&gt;    log&lt;span style=&quot;color:#3f9101;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;f&quot;Sending request to API6 for bpId: &lt;/span&gt;&lt;span style=&quot;color:#0e4a8e;&quot;&gt;{&lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;bpId&lt;/span&gt;&lt;span style=&quot;color:#0e4a8e;&quot;&gt;}&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;&quot;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;)&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;answer &lt;/span&gt;= send_request6&lt;span style=&quot;color:#3f9101;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;bpId&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;)&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;    &lt;/span&gt;log&lt;span style=&quot;color:#3f9101;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;f&quot;Получен ответ на запрос к API6: &lt;/span&gt;&lt;span style=&quot;color:#0e4a8e;&quot;&gt;{&lt;/span&gt;&lt;span style=&quot;color:#000080;&quot;&gt;str&lt;/span&gt;&lt;span style=&quot;color:#b4960a;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;answer&lt;/span&gt;&lt;span style=&quot;color:#b4960a;&quot;&gt;)&lt;/span&gt;&lt;span style=&quot;color:#0e4a8e;&quot;&gt;}&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;&quot;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;)&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color:#0033b3;&quot;&gt;return &lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;answer&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;/pre&gt;&lt;/div&gt;" id="Vc2Rvw61kaMBHnZ_WlHz-2">
          <mxCell style="text;whiteSpace=wrap;html=1;" vertex="1" parent="1">
            <mxGeometry x="390" y="-5640" width="560" height="210" as="geometry" />
          </mxCell>
        </UserObject>
        <UserObject label="&lt;div style=&quot;background-color:#ffffff;color:#080808&quot;&gt;&lt;pre style=&quot;font-family:&#39;JetBrains Mono&#39;,monospace;font-size:9,8pt;&quot;&gt;&lt;span style=&quot;color:#0033b3;&quot;&gt;from &lt;/span&gt;app.basic_entities.utils.rejections.api_7_ift &lt;span style=&quot;color:#0033b3;&quot;&gt;import &lt;/span&gt;send_get_request &lt;span style=&quot;color:#0033b3;&quot;&gt;as &lt;/span&gt;send_request7&lt;br&gt;&lt;span style=&quot;color:#0033b3;&quot;&gt;from &lt;/span&gt;core.logging.logger_utils &lt;span style=&quot;color:#0033b3;&quot;&gt;import &lt;/span&gt;log&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;span style=&quot;color:#0033b3;&quot;&gt;def &lt;/span&gt;&lt;span style=&quot;color:#00627a;&quot;&gt;send_get_request&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;bpId&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;)&lt;/span&gt;:&lt;br&gt;    &lt;span style=&quot;color:#000000;&quot;&gt;answer &lt;/span&gt;= send_request7&lt;span style=&quot;color:#3f9101;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;bpId&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;)&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;    &lt;/span&gt;log&lt;span style=&quot;color:#3f9101;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;f&quot;Получен ответ на запрос к API7. &lt;/span&gt;&lt;span style=&quot;color:#0e4a8e;&quot;&gt;{&lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;bpId&lt;/span&gt;&lt;span style=&quot;color:#0e4a8e;&quot;&gt;}&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;: &lt;/span&gt;&lt;span style=&quot;color:#0e4a8e;&quot;&gt;{&lt;/span&gt;&lt;span style=&quot;color:#000080;&quot;&gt;str&lt;/span&gt;&lt;span style=&quot;color:#b4960a;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;answer&lt;/span&gt;&lt;span style=&quot;color:#b4960a;&quot;&gt;)&lt;/span&gt;&lt;span style=&quot;color:#0e4a8e;&quot;&gt;}&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;&quot;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;)&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color:#0033b3;&quot;&gt;return &lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;answer&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;# if answer:&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    #     log(f&quot;Получен ответ на запрос к API7. {bpId}: {str(answer)}&quot;)&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    #     return  answer&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    # else:&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    #     answer = {&quot;clustId&quot;: &quot;OVERDRAFT&quot;,&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    #           &quot;checks&quot;: [&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    #               {&quot;code&quot;: &quot;8.noBo&quot;,&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    #                &quot;name&quot;: &quot;Нет ни одного БО для клиента&quot;,&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    #                &quot;result&quot;: &quot;FAIL&quot;},&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    #               {&quot;code&quot;: &quot;9.noBo&quot;,&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    #                &quot;name&quot;: &quot;Нет ни одного БО для клиента&quot;,&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    #                &quot;result&quot;: &quot;FAIL&quot;},&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    #               {&quot;code&quot;: &quot;10.noBo&quot;,&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    #                &quot;name&quot;: &quot;Нет ни одного БО для клиента&quot;,&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    #                &quot;result&quot;: &quot;FAIL&quot;},&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    #               {&quot;code&quot;: &quot;SYNTH_CODE&quot;,&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    #                &quot;name&quot;: &quot;Синтетический код ошибки&quot;,&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    #                &quot;result&quot;: &quot;FAIL&quot;}&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    #               ]&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    #           }&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    #     log(f&quot;ИСПОЛЬЗУЕТСЯ СИНТЕЗИРОВАННЫЙ ОТВЕТ НА ЗАПРОС к API7. {bpId}: {str(answer)}&quot;)&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    #     return answer&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;/pre&gt;&lt;/div&gt;" link="&lt;div style=&quot;background-color:#ffffff;color:#080808&quot;&gt;&lt;pre style=&quot;font-family:&#39;JetBrains Mono&#39;,monospace;font-size:9,8pt;&quot;&gt;&lt;span style=&quot;color:#0033b3;&quot;&gt;from &lt;/span&gt;app.basic_entities.utils.rejections.api_7_ift &lt;span style=&quot;color:#0033b3;&quot;&gt;import &lt;/span&gt;send_get_request &lt;span style=&quot;color:#0033b3;&quot;&gt;as &lt;/span&gt;send_request7&lt;br&gt;&lt;span style=&quot;color:#0033b3;&quot;&gt;from &lt;/span&gt;core.logging.logger_utils &lt;span style=&quot;color:#0033b3;&quot;&gt;import &lt;/span&gt;log&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;span style=&quot;color:#0033b3;&quot;&gt;def &lt;/span&gt;&lt;span style=&quot;color:#00627a;&quot;&gt;send_get_request&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;bpId&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;)&lt;/span&gt;:&lt;br&gt;    &lt;span style=&quot;color:#000000;&quot;&gt;answer &lt;/span&gt;= send_request7&lt;span style=&quot;color:#3f9101;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;bpId&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;)&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;    &lt;/span&gt;log&lt;span style=&quot;color:#3f9101;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;f&quot;Получен ответ на запрос к API7. &lt;/span&gt;&lt;span style=&quot;color:#0e4a8e;&quot;&gt;{&lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;bpId&lt;/span&gt;&lt;span style=&quot;color:#0e4a8e;&quot;&gt;}&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;: &lt;/span&gt;&lt;span style=&quot;color:#0e4a8e;&quot;&gt;{&lt;/span&gt;&lt;span style=&quot;color:#000080;&quot;&gt;str&lt;/span&gt;&lt;span style=&quot;color:#b4960a;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;answer&lt;/span&gt;&lt;span style=&quot;color:#b4960a;&quot;&gt;)&lt;/span&gt;&lt;span style=&quot;color:#0e4a8e;&quot;&gt;}&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;&quot;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;)&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color:#0033b3;&quot;&gt;return &lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;answer&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;# if answer:&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    #     log(f&quot;Получен ответ на запрос к API7. {bpId}: {str(answer)}&quot;)&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    #     return  answer&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    # else:&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    #     answer = {&quot;clustId&quot;: &quot;OVERDRAFT&quot;,&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    #           &quot;checks&quot;: [&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    #               {&quot;code&quot;: &quot;8.noBo&quot;,&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    #                &quot;name&quot;: &quot;Нет ни одного БО для клиента&quot;,&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    #                &quot;result&quot;: &quot;FAIL&quot;},&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    #               {&quot;code&quot;: &quot;9.noBo&quot;,&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    #                &quot;name&quot;: &quot;Нет ни одного БО для клиента&quot;,&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    #                &quot;result&quot;: &quot;FAIL&quot;},&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    #               {&quot;code&quot;: &quot;10.noBo&quot;,&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    #                &quot;name&quot;: &quot;Нет ни одного БО для клиента&quot;,&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    #                &quot;result&quot;: &quot;FAIL&quot;},&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    #               {&quot;code&quot;: &quot;SYNTH_CODE&quot;,&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    #                &quot;name&quot;: &quot;Синтетический код ошибки&quot;,&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    #                &quot;result&quot;: &quot;FAIL&quot;}&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    #               ]&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    #           }&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    #     log(f&quot;ИСПОЛЬЗУЕТСЯ СИНТЕЗИРОВАННЫЙ ОТВЕТ НА ЗАПРОС к API7. {bpId}: {str(answer)}&quot;)&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    #     return answer&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;/pre&gt;&lt;/div&gt;" id="Vc2Rvw61kaMBHnZ_WlHz-3">
          <mxCell style="text;whiteSpace=wrap;html=1;" vertex="1" parent="1">
            <mxGeometry x="-330" y="-5810" width="560" height="510" as="geometry" />
          </mxCell>
        </UserObject>
        <UserObject label="&lt;div style=&quot;background-color:#ffffff;color:#080808&quot;&gt;&lt;pre style=&quot;font-family:&#39;JetBrains Mono&#39;,monospace;font-size:9,8pt;&quot;&gt;&lt;span style=&quot;color:#0033b3;&quot;&gt;from &lt;/span&gt;app.basic_entities.utils.rejections.api_8_ift &lt;span style=&quot;color:#0033b3;&quot;&gt;import &lt;/span&gt;send_get_request &lt;span style=&quot;color:#0033b3;&quot;&gt;as &lt;/span&gt;send_request8&lt;br&gt;&lt;span style=&quot;color:#0033b3;&quot;&gt;from &lt;/span&gt;core.logging.logger_utils &lt;span style=&quot;color:#0033b3;&quot;&gt;import &lt;/span&gt;log&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;span style=&quot;color:#0033b3;&quot;&gt;def &lt;/span&gt;&lt;span style=&quot;color:#00627a;&quot;&gt;send_get_request&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;ucpId&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;)&lt;/span&gt;:&lt;br&gt;    &lt;span style=&quot;color:#000000;&quot;&gt;answer &lt;/span&gt;= send_request8&lt;span style=&quot;color:#3f9101;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;ucpId&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;)&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;    &lt;/span&gt;log&lt;span style=&quot;color:#3f9101;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;f&quot;Получен ответ на запрос к API8. &lt;/span&gt;&lt;span style=&quot;color:#0e4a8e;&quot;&gt;{&lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;ucpId&lt;/span&gt;&lt;span style=&quot;color:#0e4a8e;&quot;&gt;}&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;: &lt;/span&gt;&lt;span style=&quot;color:#0e4a8e;&quot;&gt;{&lt;/span&gt;&lt;span style=&quot;color:#000080;&quot;&gt;str&lt;/span&gt;&lt;span style=&quot;color:#b4960a;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;answer&lt;/span&gt;&lt;span style=&quot;color:#b4960a;&quot;&gt;)&lt;/span&gt;&lt;span style=&quot;color:#0e4a8e;&quot;&gt;}&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;&quot;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;)&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color:#0033b3;&quot;&gt;return &lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;answer&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;# if answer:&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    #  log(f&quot;Получен ответ на запрос к API8. {ucpId}: {str(answer)}&quot;)&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    #  return answer&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    # else:&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    #  answer = {&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    #  &quot;ucpId&quot;:&quot;1189423233359845359&quot;,&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    #  &quot;isCreditFlg&quot;:&quot;FALSE&quot;,&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    #  &quot;is151FZFlg&quot;:&quot;TRUE&quot;,&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    #  &quot;hasSensitiveFlg&quot;:&quot;FALSE&quot;,&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    #  &quot;existEioResidentUnfriendlyCountryFlg&quot;:&quot;FALSE&quot;,&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    #  &quot;eioSigners&quot;: {&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    #  &quot;managmentCompanies&quot;: [&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    #     {&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    #        &quot;fullName&quot;:&quot;ООО Рога и Копыта&quot;,&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    #        &quot;opf&quot;:&quot;12345&quot;,&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    #        &quot;ogrn&quot;:&quot;123456789012345&quot;,&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    #        &quot;signers&quot;: [&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    #           {&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    #        &quot;lastName&quot;:&quot;Иванов&quot;,&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    #        &quot;firstName&quot;:&quot;Иван&quot;,&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    #        &quot;middleName&quot;:&quot;Иванович&quot;,&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    #        &quot;position&quot;:&quot;ДИРЕКТОР&quot;,&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    #        &quot;hasResidentFlg&quot;:&quot;TRUE&quot;,&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    #        &quot;hasResidentUnfriendlyCountryFlg&quot;:&quot;FALSE&quot;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    #           }&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    #        ]&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    #     }&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    #        ],&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    #        &quot;eio&quot;: [&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    #     {&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    #        &quot;lastName&quot;:&quot;Иванов&quot;,&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    #        &quot;firstName&quot;:&quot;Иван&quot;,&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    #        &quot;middleName&quot;:&quot;Иванович&quot;,&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    #        &quot;position&quot;:&quot;ДИРЕКТОР&quot;,&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    #        &quot;hasResidentFlg&quot;:&quot;TRUE&quot;,&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    #        &quot;hasResidentUnfriendlyCountryFlg&quot;:&quot;FALSE&quot;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    #     }&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    #        ]&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    #     },&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    #     &quot;orgInfoByRoles&quot;: {&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    #        &quot;borrowerInfo&quot;: {&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    #     &quot;checksByProducts&quot;: [&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    #        {&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    #           &quot;productName&quot;:&quot;CORP_CRED&quot;,&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    #           &quot;checkStatus&quot;:&quot;FALSE&quot;,&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    #           &quot;ckpChecks&quot;: [&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    #        {&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    #           &quot;checkCode&quot;:&quot;ЕКС ID&quot;,&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    #           &quot;checkType&quot;:&quot;HARD&quot;,&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    #           &quot;checkStatus&quot;:&quot;FALSE&quot;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    #        }&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    #           ]&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    #        }&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    #     ]&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    #        },&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    #        &quot;suretyInfo&quot;: {&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    #     &quot;checksByProducts&quot;: [&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    #        {&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    #           &quot;productName&quot;:&quot;CORP_CRED&quot;,&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    #           &quot;checkStatus&quot;:&quot;FALSE&quot;,&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    #           &quot;ckpChecks&quot;: [&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    #        {&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    #           &quot;checkCode&quot;:&quot;ЕКС ID&quot;,&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    #           &quot;checkType&quot;:&quot;HARD&quot;,&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    #           &quot;checkStatus&quot;:&quot;FALSE&quot;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    #        }&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    #           ]&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    #        }&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    #     ]&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    #        },&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    #        &quot;pledgerInfo&quot;: {&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    #     &quot;checksByProducts&quot;: [&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    #        {&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    #           &quot;productName&quot;:&quot;CORP_CRED&quot;,&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    #           &quot;checkStatus&quot;:&quot;FALSE&quot;,&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    #           &quot;ckpChecks&quot;: [&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    #        {&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    #           &quot;checkCode&quot;:&quot;ЕКС ID&quot;,&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    #           &quot;checkType&quot;:&quot;HARD&quot;,&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    #           &quot;checkStatus&quot;:&quot;FALSE&quot;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    #        }&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    #           ]&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    #        }&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    #     ]&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    #        }&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    #     }&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    #  }&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    #  log(f&quot;ИСПОЛЬЗУЕТСЯ СИНТЕЗИРОВАННЫЙ ОТВЕТ НА ЗАПРОС к API8. {ucpId}: {str(answer)}&quot;)&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    #  return answer&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    #&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;/pre&gt;&lt;/div&gt;" link="&lt;div style=&quot;background-color:#ffffff;color:#080808&quot;&gt;&lt;pre style=&quot;font-family:&#39;JetBrains Mono&#39;,monospace;font-size:9,8pt;&quot;&gt;&lt;span style=&quot;color:#0033b3;&quot;&gt;from &lt;/span&gt;app.basic_entities.utils.rejections.api_8_ift &lt;span style=&quot;color:#0033b3;&quot;&gt;import &lt;/span&gt;send_get_request &lt;span style=&quot;color:#0033b3;&quot;&gt;as &lt;/span&gt;send_request8&lt;br&gt;&lt;span style=&quot;color:#0033b3;&quot;&gt;from &lt;/span&gt;core.logging.logger_utils &lt;span style=&quot;color:#0033b3;&quot;&gt;import &lt;/span&gt;log&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;span style=&quot;color:#0033b3;&quot;&gt;def &lt;/span&gt;&lt;span style=&quot;color:#00627a;&quot;&gt;send_get_request&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;ucpId&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;)&lt;/span&gt;:&lt;br&gt;    &lt;span style=&quot;color:#000000;&quot;&gt;answer &lt;/span&gt;= send_request8&lt;span style=&quot;color:#3f9101;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;ucpId&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;)&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;    &lt;/span&gt;log&lt;span style=&quot;color:#3f9101;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;f&quot;Получен ответ на запрос к API8. &lt;/span&gt;&lt;span style=&quot;color:#0e4a8e;&quot;&gt;{&lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;ucpId&lt;/span&gt;&lt;span style=&quot;color:#0e4a8e;&quot;&gt;}&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;: &lt;/span&gt;&lt;span style=&quot;color:#0e4a8e;&quot;&gt;{&lt;/span&gt;&lt;span style=&quot;color:#000080;&quot;&gt;str&lt;/span&gt;&lt;span style=&quot;color:#b4960a;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;answer&lt;/span&gt;&lt;span style=&quot;color:#b4960a;&quot;&gt;)&lt;/span&gt;&lt;span style=&quot;color:#0e4a8e;&quot;&gt;}&lt;/span&gt;&lt;span style=&quot;color:#067d17;&quot;&gt;&quot;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;)&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#3f9101;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color:#0033b3;&quot;&gt;return &lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;answer&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#000000;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;# if answer:&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    #  log(f&quot;Получен ответ на запрос к API8. {ucpId}: {str(answer)}&quot;)&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    #  return answer&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    # else:&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    #  answer = {&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    #  &quot;ucpId&quot;:&quot;1189423233359845359&quot;,&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    #  &quot;isCreditFlg&quot;:&quot;FALSE&quot;,&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    #  &quot;is151FZFlg&quot;:&quot;TRUE&quot;,&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    #  &quot;hasSensitiveFlg&quot;:&quot;FALSE&quot;,&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    #  &quot;existEioResidentUnfriendlyCountryFlg&quot;:&quot;FALSE&quot;,&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    #  &quot;eioSigners&quot;: {&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    #  &quot;managmentCompanies&quot;: [&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    #     {&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    #        &quot;fullName&quot;:&quot;ООО Рога и Копыта&quot;,&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    #        &quot;opf&quot;:&quot;12345&quot;,&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    #        &quot;ogrn&quot;:&quot;123456789012345&quot;,&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    #        &quot;signers&quot;: [&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    #           {&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    #        &quot;lastName&quot;:&quot;Иванов&quot;,&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    #        &quot;firstName&quot;:&quot;Иван&quot;,&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    #        &quot;middleName&quot;:&quot;Иванович&quot;,&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    #        &quot;position&quot;:&quot;ДИРЕКТОР&quot;,&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    #        &quot;hasResidentFlg&quot;:&quot;TRUE&quot;,&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    #        &quot;hasResidentUnfriendlyCountryFlg&quot;:&quot;FALSE&quot;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    #           }&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    #        ]&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    #     }&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    #        ],&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    #        &quot;eio&quot;: [&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    #     {&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    #        &quot;lastName&quot;:&quot;Иванов&quot;,&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    #        &quot;firstName&quot;:&quot;Иван&quot;,&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    #        &quot;middleName&quot;:&quot;Иванович&quot;,&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    #        &quot;position&quot;:&quot;ДИРЕКТОР&quot;,&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    #        &quot;hasResidentFlg&quot;:&quot;TRUE&quot;,&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    #        &quot;hasResidentUnfriendlyCountryFlg&quot;:&quot;FALSE&quot;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    #     }&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    #        ]&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    #     },&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    #     &quot;orgInfoByRoles&quot;: {&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    #        &quot;borrowerInfo&quot;: {&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    #     &quot;checksByProducts&quot;: [&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    #        {&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    #           &quot;productName&quot;:&quot;CORP_CRED&quot;,&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    #           &quot;checkStatus&quot;:&quot;FALSE&quot;,&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    #           &quot;ckpChecks&quot;: [&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    #        {&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    #           &quot;checkCode&quot;:&quot;ЕКС ID&quot;,&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    #           &quot;checkType&quot;:&quot;HARD&quot;,&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    #           &quot;checkStatus&quot;:&quot;FALSE&quot;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    #        }&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    #           ]&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    #        }&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    #     ]&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    #        },&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    #        &quot;suretyInfo&quot;: {&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    #     &quot;checksByProducts&quot;: [&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    #        {&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    #           &quot;productName&quot;:&quot;CORP_CRED&quot;,&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    #           &quot;checkStatus&quot;:&quot;FALSE&quot;,&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    #           &quot;ckpChecks&quot;: [&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    #        {&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    #           &quot;checkCode&quot;:&quot;ЕКС ID&quot;,&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    #           &quot;checkType&quot;:&quot;HARD&quot;,&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    #           &quot;checkStatus&quot;:&quot;FALSE&quot;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    #        }&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    #           ]&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    #        }&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    #     ]&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    #        },&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    #        &quot;pledgerInfo&quot;: {&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    #     &quot;checksByProducts&quot;: [&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    #        {&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    #           &quot;productName&quot;:&quot;CORP_CRED&quot;,&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    #           &quot;checkStatus&quot;:&quot;FALSE&quot;,&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    #           &quot;ckpChecks&quot;: [&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    #        {&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    #           &quot;checkCode&quot;:&quot;ЕКС ID&quot;,&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    #           &quot;checkType&quot;:&quot;HARD&quot;,&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    #           &quot;checkStatus&quot;:&quot;FALSE&quot;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    #        }&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    #           ]&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    #        }&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    #     ]&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    #        }&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    #     }&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    #  }&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    #  log(f&quot;ИСПОЛЬЗУЕТСЯ СИНТЕЗИРОВАННЫЙ ОТВЕТ НА ЗАПРОС к API8. {ucpId}: {str(answer)}&quot;)&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    #  return answer&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;    #&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#8c8c8c;font-style:italic;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;/pre&gt;&lt;/div&gt;" id="Vc2Rvw61kaMBHnZ_WlHz-4">
          <mxCell style="text;whiteSpace=wrap;html=1;" vertex="1" parent="1">
            <mxGeometry x="414" y="-5450" width="560" height="1470" as="geometry" />
          </mxCell>
        </UserObject>
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
